{
  "format" : "9.4.20",
  "id" : "169B3B7F5EF38D8F",
  "data" : "com.axonivy.connectivity.Data",
  "elements" : [ {
      "id" : "f0",
      "type" : "RequestStart",
      "name" : "fileClient.ivp",
      "config" : {
        "callSignature" : "fileClient",
        "startCategory" : "rest/mapping/file",
        "outLink" : "fileClient.ivp",
        "startCustomFields" : [
          { "name" : "cssIcon", "value" : "fa fa-upload" }
        ],
        "startName" : "6.4.0 Upload file UI"
      },
      "visual" : {
        "at" : { "x" : 96, "y" : 120 },
        "labelOffset" : { "x" : 20, "y" : 37 }
      },
      "connect" : { "id" : "f4", "to" : "f3" }
    }, {
      "id" : "f1",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 352, "y" : 120 }
      }
    }, {
      "id" : "f3",
      "type" : "DialogCall",
      "name" : "File Upload Form",
      "config" : {
        "dialogId" : "com.axonivy.connectivity.rest.FileUpload",
        "startMethod" : "start(com.axonivy.connectivity.Data)",
        "call" : {
          "params" : [
            { "name" : "data", "type" : "com.axonivy.connectivity.Data" }
          ]
        }
      },
      "visual" : {
        "at" : { "x" : 224, "y" : 120 }
      },
      "connect" : { "id" : "f2", "to" : "f1" }
    }, {
      "id" : "f5",
      "type" : "ProcessAnnotation",
      "name" : "This Demo uses a Rest Service Call to upload a File",
      "visual" : {
        "at" : { "x" : 224, "y" : 32 },
        "size" : { "width" : 336, "height" : 30 }
      }
    }, {
      "id" : "f6",
      "type" : "RequestStart",
      "name" : "fileMultipart.ivp",
      "config" : {
        "callSignature" : "fileMultipart",
        "startCategory" : "rest/mapping/file",
        "outLink" : "fileMultipart.ivp",
        "startCustomFields" : [
          { "name" : "cssIcon", "value" : "fa fa-upload" }
        ],
        "input" : {
          "code" : [
            "import com.axonivy.connectivity.rest.client.file.FileUpload;",
            "out.file = FileUpload.getIvyLogo();"
          ]
        },
        "startName" : "6.4.1 Upload file multipart"
      },
      "visual" : {
        "at" : { "x" : 96, "y" : 320 },
        "labelOffset" : { "x" : 17, "y" : 37 }
      },
      "connect" : { "id" : "f9", "to" : "f8" }
    }, {
      "id" : "f7",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 352, "y" : 320 }
      }
    }, {
      "id" : "f8",
      "type" : "RestClientCall",
      "name" : [
        "Upload File",
        "(multi/part)"
      ],
      "config" : {
        "bodyForm" : {
          "file" : [
            "in.file",
            "com.axonivy.connectivity.rest.client.file.FileUpload.getIvyLogo()"
          ],
          "description" : "",
          "ownerId" : ""
        },
        "path" : "/file",
        "headers" : {
          "Accept" : "*/*",
          "X-Requested-By" : "\"ivy\""
        },
        "clientId" : "4d9a8b09-9968-4476-a8ac-b71a94d25e94",
        "clientErrorCode" : "ivy:error:rest:client",
        "method" : "PUT",
        "statusErrorCode" : "ivy:error:rest:client",
        "bodyObjectType" : "ivy.local.client.Body3",
        "bodyInputType" : "FORM",
        "bodyMediaType" : "multipart/form-data",
        "responseCode" : [
          "String result = response.readEntity(String.class) as String;",
          "ivy.log.info(result);",
          "out.result = result;"
        ]
      },
      "visual" : {
        "at" : { "x" : 224, "y" : 320 }
      },
      "connect" : { "id" : "f10", "to" : "f7" }
    }, {
      "id" : "f16",
      "type" : "RequestStart",
      "name" : "upAndDown.ivp",
      "config" : {
        "callSignature" : "upAndDown",
        "startCategory" : "rest/mapping/file",
        "outLink" : "upAndDown.ivp",
        "startCustomFields" : [
          { "name" : "cssIcon", "value" : "fa fa-upload" }
        ],
        "input" : {
          "code" : [
            "import com.axonivy.connectivity.rest.client.file.FileUpload;",
            "out.file = FileUpload.getIvyLogo();"
          ]
        },
        "startName" : "6.4.2 Upload and Download file octet-stream"
      },
      "visual" : {
        "at" : { "x" : 96, "y" : 224 },
        "labelOffset" : { "x" : 13, "y" : 37 }
      },
      "connect" : { "id" : "f19", "to" : "f17" }
    }, {
      "id" : "f17",
      "type" : "RestClientCall",
      "name" : [
        "  Upload File",
        "(octet stream)"
      ],
      "config" : {
        "headers" : {
          "Accept" : "*/*",
          "X-Requested-By" : "\"ivy\""
        },
        "bodyObjectMapping" : {
          "param" : "in.file"
        },
        "clientId" : "4d9a8b09-9968-4476-a8ac-b71a94d25e94",
        "method" : "POST",
        "statusErrorCode" : "ivy:error:rest:client",
        "bodyObjectType" : "java.io.File",
        "bodyInputType" : "ENTITY",
        "path" : "/file/{fileName}",
        "clientErrorCode" : "ivy:error:rest:client",
        "clientCode" : [
          "import javax.ws.rs.core.Response;",
          "import javax.ws.rs.core.MediaType;",
          "import javax.ws.rs.client.Entity;",
          "",
          "Response response = client.request()",
          "  .header(\"X-Requested-By\", \"ivy\")",
          "  .post(Entity.entity(in.file, MediaType.APPLICATION_OCTET_STREAM_TYPE));",
          "",
          "String uploaded = response.getHeaderString(\"uploadedFile\");",
          "ivy.session.setAttribute(\"lastUpload\", uploaded);",
          "",
          "ivy.log.info(\"Result: \"+response.readEntity(String.class));"
        ],
        "responseMapping" : {
          "out.result" : "response.getHeaderString(\"uploadedFile\")"
        },
        "templateParams" : {
          "fileName" : "in.file.getName()"
        },
        "resultType" : "[B",
        "bodyMediaType" : "application/octet-stream"
      },
      "visual" : {
        "at" : { "x" : 224, "y" : 224 },
        "size" : { "width" : 112, "height" : 48 }
      },
      "connect" : { "id" : "f23", "to" : "f21" }
    }, {
      "id" : "f18",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 512, "y" : 224 }
      }
    }, {
      "id" : "f21",
      "type" : "RestClientCall",
      "name" : [
        "Download File",
        "(octet stream)"
      ],
      "config" : {
        "path" : "/file/{fileName}",
        "clientId" : "4d9a8b09-9968-4476-a8ac-b71a94d25e94",
        "clientErrorCode" : "ivy:error:rest:client",
        "statusErrorCode" : "ivy:error:rest:client",
        "templateParams" : {
          "fileName" : "in.result"
        },
        "resultType" : "java.io.File",
        "responseCode" : "ivy.log.info(\"got file: \"+result);"
      },
      "visual" : {
        "at" : { "x" : 384, "y" : 224 },
        "size" : { "width" : 128, "height" : 60 }
      },
      "connect" : { "id" : "f20", "to" : "f18" }
    }, {
      "id" : "f11",
      "type" : "TaskEnd",
      "visual" : {
        "at" : { "x" : 352, "y" : 416 }
      }
    }, {
      "id" : "f12",
      "type" : "RestClientCall",
      "name" : [
        "Upload Files",
        "(multi/part)"
      ],
      "config" : {
        "bodyForm" : {
          "files" : "[in.file, com.axonivy.connectivity.rest.client.file.FileUpload.getIvyLogo()]",
          "description" : "\"some logos\"",
          "ownerId" : "-1"
        },
        "path" : "/file/multi",
        "headers" : {
          "Accept" : "*/*",
          "X-Requested-By" : "\"ivy\""
        },
        "clientId" : "4d9a8b09-9968-4476-a8ac-b71a94d25e94",
        "method" : "PUT",
        "bodyObjectType" : "ivy.local.client.Body3",
        "bodyInputType" : "FORM",
        "bodyMediaType" : "multipart/form-data"
      },
      "visual" : {
        "at" : { "x" : 224, "y" : 416 }
      },
      "connect" : { "id" : "f14", "to" : "f11" }
    }, {
      "id" : "f13",
      "type" : "RequestStart",
      "name" : "multipleFiles.ivp",
      "config" : {
        "callSignature" : "multipleFiles",
        "startCategory" : "rest/mapping/file",
        "outLink" : "multipleFiles.ivp",
        "startCustomFields" : [
          { "name" : "cssIcon", "value" : "fa fa-upload" }
        ],
        "input" : {
          "code" : [
            "import com.axonivy.connectivity.rest.client.file.FileUpload;",
            "out.file = FileUpload.getIvyLogo();"
          ]
        },
        "startName" : "6.4.2 Upload many files at once"
      },
      "visual" : {
        "at" : { "x" : 96, "y" : 416 },
        "labelOffset" : { "x" : 19, "y" : 37 }
      },
      "connect" : { "id" : "f15", "to" : "f12" }
    } ]
}