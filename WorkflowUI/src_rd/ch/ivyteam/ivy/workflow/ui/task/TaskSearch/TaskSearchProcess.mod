[Ivy]
[>Created: Thu May 28 15:49:57 CEST 2009]
1175F14B3894BBC3 3.11 #module
>Proto >Proto Collection #zClass
Ts0 TaskSearchProcess Big #zClass
Ts0 RD #cInfo
Ts0 #process
Ts0 @TextInP .resExport .resExport #zField
Ts0 @TextInP .type .type #zField
Ts0 @TextInP .processKind .processKind #zField
Ts0 @TextInP .xml .xml #zField
Ts0 @TextInP .responsibility .responsibility #zField
Ts0 @TextInP .ui2RdDataAction .ui2RdDataAction #zField
Ts0 @TextInP .rdData2UIAction .rdData2UIAction #zField
Ts0 @AnnotationInP-0n ai ai #zField
Ts0 @MessageFlowInP-0n messageIn messageIn #zField
Ts0 @MessageFlowOutP-0n messageOut messageOut #zField
Ts0 @RichDialogInitStart f0 '' #zField
Ts0 @RichDialogProcessStart f3 '' #zField
Ts0 @RichDialogProcessEnd f4 '' #zField
Ts0 @RichDialogProcessStart f14 '' #zField
Ts0 @RichDialogProcessEnd f15 '' #zField
Ts0 @Alternative f16 '' #zField
Ts0 @Alternative f30 '' #zField
Ts0 @RichDialogProcessStep f33 '' #zField
Ts0 @PushWFArc f38 '' #zField
Ts0 @RichDialogProcessStart f46 '' #zField
Ts0 @RichDialogProcessEnd f47 '' #zField
Ts0 @RichDialogProcessStep f49 '' #zField
Ts0 @Alternative f28 '' #zField
Ts0 @RichDialogProcessStep f68 '' #zField
Ts0 @PushWFArc f69 '' #zField
Ts0 @RichDialogProcessEnd f71 '' #zField
Ts0 @PushWFArc f17 '' #zField
Ts0 @PushWFArc f27 '' #zField
Ts0 @Alternative f42 '' #zField
Ts0 @PushWFArc f43 '' #zField
Ts0 @PushWFArc f19 '' #zField
Ts0 @RichDialogProcessEnd f153 '' #zField
Ts0 @PushWFArc f154 '' #zField
Ts0 @RichDialogProcessStart f11 '' #zField
Ts0 @RichDialogProcessEnd f18 '' #zField
Ts0 @RichDialogProcessStep f186 '' #zField
Ts0 @Alternative f188 '' #zField
Ts0 @PushWFArc f190 '' #zField
Ts0 @PushWFArc f162 '' #zField
Ts0 @PushWFArc f20 '' #zField
Ts0 @RichDialog f36 '' #zField
Ts0 @Alternative f55 '' #zField
Ts0 @PushWFArc f57 '' #zField
Ts0 @PushWFArc f58 '' #zField
Ts0 @RichDialogProcessStep f62 '' #zField
Ts0 @RichDialogProcessStep f63 '' #zField
Ts0 @RichDialogProcessStep f70 '' #zField
Ts0 @RichDialogProcessStep f82 '' #zField
Ts0 @RichDialogProcessStep f156 '' #zField
Ts0 @PushWFArc f157 '' #zField
Ts0 @PushWFArc f158 '' #zField
Ts0 @PushWFArc f159 '' #zField
Ts0 @PushWFArc f160 '' #zField
Ts0 @PushWFArc f161 '' #zField
Ts0 @RichDialogProcessStep f177 '' #zField
Ts0 @PushWFArc f178 '' #zField
Ts0 @RichDialogProcessStep f23 '' #zField
Ts0 @PushWFArc f179 '' #zField
Ts0 @RichDialogProcessStart f1 '' #zField
Ts0 @PushWFArc f2 '' #zField
Ts0 @RichDialogProcessStart f22 '' #zField
Ts0 @RichDialogProcessEnd f25 '' #zField
Ts0 @Alternative f31 '' #zField
Ts0 @PushWFArc f32 '' #zField
Ts0 @RichDialogProcessStep f35 '' #zField
Ts0 @PushWFArc f40 '' #zField
Ts0 @PushWFArc f39 '' #zField
Ts0 @RichDialog f45 '' #zField
Ts0 @Alternative f59 '' #zField
Ts0 @PushWFArc f64 '' #zField
Ts0 @RichDialogProcessStep f72 '' #zField
Ts0 @PushWFArc f73 '' #zField
Ts0 @Alternative f75 '' #zField
Ts0 @RichDialog f77 '' #zField
Ts0 @RichDialogInitStart f81 '' #zField
Ts0 @PushWFArc f84 '' #zField
Ts0 @PushWFArc f80 '' #zField
Ts0 @RichDialogProcessStep f94 '' #zField
Ts0 @PushWFArc f95 '' #zField
Ts0 @RichDialogProcessStart f21 '' #zField
Ts0 @RichDialogProcessEnd f44 '' #zField
Ts0 @Alternative f52 '' #zField
Ts0 @PushWFArc f53 '' #zField
Ts0 @RichDialogProcessStep f60 '' #zField
Ts0 @PushWFArc f92 '' #zField
Ts0 @RichDialogProcessStep f48 '' #zField
Ts0 @Alternative f102 '' #zField
Ts0 @PushWFArc f103 '' #zField
Ts0 @RichDialog f104 '' #zField
Ts0 @PushWFArc f105 '' #zField
Ts0 @PushWFArc f101 '' #zField
Ts0 @PushWFArc f106 '' #zField
Ts0 @RichDialogProcessStep f107 '' #zField
Ts0 @PushWFArc f108 '' #zField
Ts0 @Alternative f109 '' #zField
Ts0 @PushWFArc f111 '' #zField
Ts0 @PushWFArc f99 '' #zField
Ts0 @PushWFArc f115 '' #zField
Ts0 @RichDialogProcessStart f112 '' #zField
Ts0 @RichDialogProcessEnd f113 '' #zField
Ts0 @Alternative f116 '' #zField
Ts0 @PushWFArc f117 '' #zField
Ts0 @RichDialogProcessStep f118 '' #zField
Ts0 @PushWFArc f119 '' #zField
Ts0 @RichDialogProcessStep f123 '' #zField
Ts0 @PushWFArc f124 '' #zField
Ts0 @PushWFArc f125 '' #zField
Ts0 @RichDialogProcessStep f114 '' #zField
Ts0 @PushWFArc f120 '' #zField
Ts0 @Alternative f126 '' #zField
Ts0 @PushWFArc f127 '' #zField
Ts0 @RichDialog f128 '' #zField
Ts0 @PushWFArc f129 '' #zField
Ts0 @PushWFArc f122 '' #zField
Ts0 @PushWFArc f130 '' #zField
Ts0 @RichDialogProcessStep f24 '' #zField
Ts0 @PushWFArc f79 '' #zField
Ts0 @PushWFArc f98 '' #zField
Ts0 @PushWFArc f131 '' #zField
Ts0 @PushWFArc f61 '' #zField
Ts0 @PushWFArc f89 '' #zField
Ts0 @PushWFArc f110 '' #zField
Ts0 @PushWFArc f121 '' #zField
Ts0 @PushWFArc f132 '' #zField
Ts0 @Alternative f5 '' #zField
Ts0 @RichDialogProcessStep f145 '' #zField
Ts0 @PushWFArc f146 '' #zField
Ts0 @PushWFArc f147 '' #zField
Ts0 @Alternative f148 '' #zField
Ts0 @RichDialogProcessStep f151 '' #zField
Ts0 @PushWFArc f152 '' #zField
Ts0 @PushWFArc f150 '' #zField
Ts0 @PushWFArc f34 '' #zField
Ts0 @RichDialogProcessStart f136 '' #zField
Ts0 @RichDialogProcessEnd f139 '' #zField
Ts0 @Alternative f141 '' #zField
Ts0 @RichDialogProcessStep f155 '' #zField
Ts0 @PushWFArc f163 '' #zField
Ts0 @PushWFArc f140 '' #zField
Ts0 @RichDialogProcessStep f166 '' #zField
Ts0 @PushWFArc f167 '' #zField
Ts0 @PushWFArc f168 '' #zField
Ts0 @Alternative f169 '' #zField
Ts0 @PushWFArc f170 '' #zField
Ts0 @PushWFArc f142 '' #zField
Ts0 @PushWFArc f87 '' #zField
Ts0 @Alternative f172 '' #zField
Ts0 @PushWFArc f56 '' #zField
Ts0 @PushWFArc f173 '' #zField
Ts0 @RichDialogProcessStart f7 '' #zField
Ts0 @RichDialogProcessEnd f10 '' #zField
Ts0 @RichDialogProcessStart f13 '' #zField
Ts0 @RichDialogProcessStep f100 '' #zField
Ts0 @PushWFArc f12 '' #zField
Ts0 @RichDialogProcessStart f37 '' #zField
Ts0 @PushWFArc f137 '' #zField
Ts0 @RichDialogProcessStep f138 '' #zField
Ts0 @PushWFArc f180 '' #zField
Ts0 @PushWFArc f9 '' #zField
Ts0 @PushWFArc f8 '' #zField
Ts0 @RichDialogProcessStep f74 '' #zField
Ts0 @PushWFArc f83 '' #zField
Ts0 @PushWFArc f134 '' #zField
Ts0 @RichDialogProcessStep f184 '' #zField
Ts0 @PushWFArc f6 '' #zField
Ts0 @RichDialogProcessStart f41 '' #zField
Ts0 @RichDialogProcessStep f54 '' #zField
Ts0 @PushWFArc f135 '' #zField
Ts0 @PushWFArc f50 '' #zField
Ts0 @RichDialogProcessStart f189 '' #zField
Ts0 @RichDialogProcessStart f192 '' #zField
Ts0 @RichDialogProcessStart f191 '' #zField
Ts0 @Alternative f196 '' #zField
Ts0 @PushWFArc f78 '' #zField
Ts0 @RichDialog f76 '' #zField
Ts0 @PushWFArc f199 '' #zField
Ts0 @PushWFArc f200 '' #zField
Ts0 @RichDialogProcessStep f51 '' #zField
Ts0 @PushWFArc f85 '' #zField
Ts0 @Alternative f88 '' #zField
Ts0 @PushWFArc f90 '' #zField
Ts0 @PushWFArc f96 '' #zField
Ts0 @PushWFArc f97 '' #zField
Ts0 @Alternative f29 '' #zField
Ts0 @Alternative f149 '' #zField
Ts0 @PushWFArc f193 '' #zField
Ts0 @PushWFArc f204 '' #zField
Ts0 @PushWFArc f91 '' #zField
Ts0 @PushWFArc f143 '' #zField
Ts0 @PushWFArc f144 '' #zField
Ts0 @RichDialogProcessStep f201 '' #zField
Ts0 @PushWFArc f205 '' #zField
Ts0 @PushWFArc f194 '' #zField
Ts0 @PushWFArc f165 '' #zField
Ts0 @PushWFArc f164 '' #zField
Ts0 @RichDialogProcessStep f206 '' #zField
Ts0 @PushWFArc f207 '' #zField
Ts0 @PushWFArc f208 '' #zField
Ts0 @RichDialogProcessStep f175 '' #zField
Ts0 @PushWFArc f211 '' #zField
Ts0 @PushWFArc f171 '' #zField
Ts0 @PushWFArc f214 '' #zField
Ts0 @RichDialogProcessStep f181 '' #zField
Ts0 @PushWFArc f182 '' #zField
Ts0 @PushWFArc f93 '' #zField
Ts0 @PushWFArc f183 '' #zField
Ts0 @PushWFArc f185 '' #zField
Ts0 @PushWFArc f197 '' #zField
Ts0 @PushWFArc f86 '' #zField
Ts0 @RichDialogProcessStart f65 '' #zField
Ts0 @RichDialogProcessEnd f66 '' #zField
Ts0 @PushWFArc f198 '' #zField
Ts0 @PushWFArc f202 '' #zField
Ts0 @RichDialogBroadcastStart f67 '' #zField
Ts0 @RichDialogProcessEnd f174 '' #zField
Ts0 @PushWFArc f176 '' #zField
Ts0 @InfoButton f209 '' #zField
Ts0 @AnnotationArc f210 '' #zField
Ts0 @Alternative f212 '' #zField
Ts0 @PushWFArc f213 '' #zField
Ts0 @PushWFArc f187 '' #zField
Ts0 @PushWFArc f216 '' #zField
Ts0 @Alternative f215 '' #zField
Ts0 @PushWFArc f217 '' #zField
Ts0 @RichDialog f218 '' #zField
Ts0 @PushWFArc f26 '' #zField
Ts0 @PushWFArc f220 '' #zField
Ts0 @PushWFArc f219 '' #zField
Ts0 @RichDialogMethodStart f221 '' #zField
Ts0 @RichDialogProcessEnd f222 '' #zField
Ts0 @RichDialogProcessStep f224 '' #zField
Ts0 @PushWFArc f225 '' #zField
Ts0 @PushWFArc f223 '' #zField
Ts0 @RichDialogProcessStep f195 '' #zField
Ts0 @PushWFArc f203 '' #zField
Ts0 @PushWFArc f133 '' #zField
>Proto Ts0 Ts0 TaskSearchProcess #zField
Ts0 f0 guid 1175F221618771FB #txt
Ts0 f0 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f0 method start() #txt
Ts0 f0 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ts0 f0 inParameterMapAction 'out.destinationDisplay=null;
out.multipleTaskListMode=false;
out.runningTaskMode=true;
out.taskDisplayMode=1;
' #txt
Ts0 f0 outParameterDecl '<> result;
' #txt
Ts0 f0 embeddedRdInitializations '{/taskHierarchyLayoutSelectRDC {/fieldName "taskHierarchyLayoutSelectRDC"/startMethod "start(Number)"/parameterMapping "param.aTaskHierarchyLayoutPrefferedIndex=1;\n"/initScript ""}/taskFiltersSelectRDC {/fieldName "taskFiltersSelectRDC"/startMethod "start()"/parameterMapping ""/initScript ""}}' #txt
Ts0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start()</name>
        <nameStyle>7,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f0 134 62 20 20 13 0 #rect
Ts0 f0 @|RichDialogInitStartIcon #fIcon
Ts0 f3 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>showTaskFiltersSelect</name>
        <nameStyle>21,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f3 guid 1175F2242B61EBF8 #txt
Ts0 f3 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f3 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f3 actionTable 'out=in;
' #txt
Ts0 f3 1902 30 20 20 13 0 #rect
Ts0 f3 @|RichDialogProcessStartIcon #fIcon
Ts0 f4 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f4 1899 243 26 26 14 0 #rect
Ts0 f4 @|RichDialogProcessEndIcon #fIcon
Ts0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>displaySelectedTasksHierarchyLayout</name>
        <nameStyle>35,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f14 guid 117A1701BB17D093 #txt
Ts0 f14 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f14 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f14 actionTable 'out=in;
' #txt
Ts0 f14 actionCode 'out.taskHierarchyLayoutSelectedIndex = 
	panel.taskHierarchyLayoutSelectRDC.getSelectedTaskHierarchyLayoutIndex();' #txt
Ts0 f14 1318 30 20 20 13 0 #rect
Ts0 f14 @|RichDialogProcessStartIcon #fIcon
Ts0 f15 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f15 1315 587 26 26 14 0 #rect
Ts0 f15 @|RichDialogProcessEndIcon #fIcon
Ts0 f16 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f16 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f16 1314 306 28 28 325 -41 #rect
Ts0 f16 @|AlternativeIcon #fIcon
Ts0 f30 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f30 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f30 1314 218 28 28 14 0 #rect
Ts0 f30 @|AlternativeIcon #fIcon
Ts0 f33 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Build all 
available priorities
considering (ON/OFF) the user filter</name>
        <nameStyle>68,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f33 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f33 actionTable 'out=in;
' #txt
Ts0 f33 actionCode '// Priority/Case process category name/Case process name/Case type name/Case sub type name

// Case process category name/Case process name/Case type name/Case sub type name

import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;
import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.persistence.IGroup;
import ch.ivyteam.ivy.workflow.IPropertyFilter;


IPropertyFilter filter = in.taskStatesPropertyFilter;
List<IGroup> prioritiesIGroup;
ITask elementOfPrioritiesITask;



Tree rootTree = in.tasksHierarchyLayoutTree;
Tree categoryTree;
Tree priorityTree;



rootTree.removeAllChildren();

prioritiesIGroup.clear();


if (in.filterEnabled)
{
	filter = filter.and(in.taskAvailableFilters.propertyFilter);	
}
	

prioritiesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, null, 
																																							in.runningTaskMode, in.taskDisplayMode));


for (IGroup priority: prioritiesIGroup)
{
   elementOfPrioritiesITask = priority.getFirstObjectInGroup() as ITask;
   
   TaskHierarchyTreeNodeValue priorityTreeNodeValue = new TaskHierarchyTreeNodeValue();
   priorityTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY;
   priorityTreeNodeValue.categoryCode = elementOfPrioritiesITask.getPriority().intValue().toString();
   priorityTreeNodeValue.categoryName = elementOfPrioritiesITask.getPriority().toString();

   priorityTree = rootTree.createChild(priorityTreeNodeValue, "PRIORITY");   
}

out.tasksHierarchyLayoutTree = rootTree;' #txt
Ts0 f33 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f33 1406 252 36 24 20 1 #rect
Ts0 f33 @|RichDialogProcessStepIcon #fIcon
Ts0 f38 expr in #txt
Ts0 f38 outCond in.sortByPriority #txt
Ts0 f38 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Sort by 
priority ON</name>
        <nameStyle>20,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f38 1342 232 1424 252 #arcP
Ts0 f38 1 1424 232 #addKink
Ts0 f38 0 0.5365853658536586 0 0 #arcLabel
Ts0 f46 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>loadTasksByTaskHierarchySelection</name>
        <nameStyle>33,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f46 guid 117AC276F6716306 #txt
Ts0 f46 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f46 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f46 actionTable 'out=in;
' #txt
Ts0 f46 actionCode 'out.taskHierarchyContext.setIcon("");
out.taskHierarchyContext.setPropertyFilter(null);
out.taskHierarchyContext.setTitle("All tasks");
out.taskHierarchyContext.setToolTipText("");
' #txt
Ts0 f46 350 726 20 20 13 0 #rect
Ts0 f46 @|RichDialogProcessStartIcon #fIcon
Ts0 f47 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f47 347 1299 26 26 14 0 #rect
Ts0 f47 @|RichDialogProcessEndIcon #fIcon
Ts0 f49 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build the taskHierarchyContext filter
according to node value object
from root to selected Tree</name>
        <nameStyle>95,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f49 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f49 actionTable 'out=in;
' #txt
Ts0 f49 actionCode 'import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.IPropertyFilter;

Tree selectedTree = panel.tasksHierarchyLayoutTree.selectedTreeNode;


if (selectedTree.value instanceof TaskHierarchyTreeNodeValue)
{

   // path from root to this tree
   List<Tree>  pathTreeList = selectedTree.getPath();

	
   // do not consider the root tree
   for (int i=1; i<pathTreeList.size(); i++)
   {
      Tree currentTree = pathTreeList.get(i);

      TaskHierarchyTreeNodeValue currentTreeNodeValue = currentTree.value as TaskHierarchyTreeNodeValue;

      out.propertiesList.add(currentTreeNodeValue.property);
      out.codesList.add(currentTreeNodeValue.categoryCode);

      if (currentTreeNodeValue.categoryCode is initialized)
      {
					out.taskHierarchyContext.propertyFilter = out.taskHierarchyContext.propertyFilter.and(
																											currentTreeNodeValue.property,
																											ch.ivyteam.logicalexpression.RelationalOperator.EQUAL,
																											currentTreeNodeValue.categoryCode);      							
      }
			else
			{
									out.taskHierarchyContext.propertyFilter = out.taskHierarchyContext.propertyFilter.and(
																											currentTreeNodeValue.property,
																											ch.ivyteam.logicalexpression.RelationalOperator.IS,
																											null);      
			}	

   }// end for


	String displayedNodeValue = (selectedTree.value as TaskHierarchyTreeNodeValue).categoryName;

	out.taskHierarchyContext.title += " - " + displayedNodeValue;
	out.taskHierarchyContext.icon = "";
	out.taskHierarchyContext.toolTipText = out.taskHierarchyContext.title;	

}' #txt
Ts0 f49 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f49 342 1044 36 24 20 -2 #rect
Ts0 f49 @|RichDialogProcessStepIcon #fIcon
Ts0 f28 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f28 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f28 346 890 28 28 14 0 #rect
Ts0 f28 @|AlternativeIcon #fIcon
Ts0 f68 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Create a new root tree node 
on the tasks hierarchy layout tree</name>
        <nameStyle>63,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f68 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f68 actionTable 'out=in;
' #txt
Ts0 f68 actionCode 'out.tasksHierarchyLayoutTree = new Tree();
out.tasksHierarchyLayoutTree.info = "Root";
out.tasksHierarchyLayoutTree.value = ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/allTasks");' #txt
Ts0 f68 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f68 1310 108 36 24 8 11 #rect
Ts0 f68 @|RichDialogProcessStepIcon #fIcon
Ts0 f69 expr out #txt
Ts0 f69 1328 50 1328 108 #arcP
Ts0 f69 0 0.49591651232108613 0 0 #arcLabel
Ts0 f71 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f71 131 531 26 26 14 0 #rect
Ts0 f71 @|RichDialogProcessEndIcon #fIcon
Ts0 f17 expr out #txt
Ts0 f17 1424 276 1340 318 #arcP
Ts0 f17 1 1424 304 #addKink
Ts0 f17 1 0.09424384851448732 0 0 #arcLabel
Ts0 f27 expr in #txt
Ts0 f27 1328 246 1328 306 #arcP
Ts0 f42 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f42 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f42 1314 162 28 28 14 0 #rect
Ts0 f42 @|AlternativeIcon #fIcon
Ts0 f43 expr out #txt
Ts0 f43 1328 132 1328 162 #arcP
Ts0 f19 expr in #txt
Ts0 f19 1328 190 1328 218 #arcP
Ts0 f153 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f153 1467 163 26 26 14 0 #rect
Ts0 f153 @|RichDialogProcessEndIcon #fIcon
Ts0 f154 expr in #txt
Ts0 f154 outCond 'in.taskHierarchyLayoutSelectedIndex < 0 || in.taskHierarchyLayoutSelectedIndex > 6' #txt
Ts0 f154 1342 176 1467 176 #arcP
Ts0 f154 0 0.4503252571144769 0 0 #arcLabel
Ts0 f11 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>expandTreeNodeAndFindTasks</name>
        <nameStyle>26,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f11 guid 11865F41E1BF67C0 #txt
Ts0 f11 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f11 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f11 actionTable 'out=in;
' #txt
Ts0 f11 actionCode 'out.treeLoadEvent = event as ch.ivyteam.ivy.richdialog.component.event.TreeLoadEvent;' #txt
Ts0 f11 1046 726 20 20 13 0 #rect
Ts0 f11 @|RichDialogProcessStartIcon #fIcon
Ts0 f18 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f18 1043 1107 26 26 14 0 #rect
Ts0 f18 @|RichDialogProcessEndIcon #fIcon
Ts0 f186 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>do the loop 
and find the tasks
that fit to selected tree path
and created tree with node value ITask</name>
        <nameStyle>101,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f186 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f186 actionTable 'out=in;
' #txt
Ts0 f186 actionCode 'import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;
import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IQueryResult;
import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.PropertyOrder;
import ch.ivyteam.ivy.workflow.IPropertyFilter;


IQueryResult queryResult;
List<ITask> result= [];
List<PropertyOrder> order = [];
java.util.EnumSet states;
IPropertyFilter filter;

int startIndex = 0;
int count = -1;
Boolean returnAllCount = true;
int allCount;

Tree taskTree;




// path from root to this tree
List<Tree>  pathTreeList = out.treeLoadEvent.getTreeNode().getPath();

// setup order
order.add(new PropertyOrder(ch.ivyteam.ivy.workflow.TaskProperty.NAME));
// order.add(new PropertyOrder(ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_NAME, ch.ivyteam.ivy.persistence.OrderDirection.ASCENDING));


// states
states = null;


// setup filter
filter = in.taskStatesPropertyFilter;

for (int i=1; i<pathTreeList.size(); i++)
{
	TaskHierarchyTreeNodeValue currentTaskHierarchyTreeNodeValue = pathTreeList.get(i).value as TaskHierarchyTreeNodeValue;

	if(currentTaskHierarchyTreeNodeValue.categoryCode is initialized)
	{
		filter = filter.and(currentTaskHierarchyTreeNodeValue.property, 
											ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, 
											currentTaskHierarchyTreeNodeValue.categoryCode);
	}
	else
	{
		filter = filter.and(currentTaskHierarchyTreeNodeValue.property, 
											ch.ivyteam.logicalexpression.RelationalOperator.IS, 
											null);									
	}
}
	
// include user defined filter
if (in.filterDefined && in.filterEnabled)
{
	filter = filter.and(in.taskAvailableFilters.propertyFilter);
}


// find 
queryResult = WorkflowUIAccessPermissionHandler.findTasks(filter, order, startIndex, count, returnAllCount, in.runningTaskMode, in.taskDisplayMode);


// results
count = queryResult.getResultCount(); // number of results returned
allCount = queryResult.getAllCount(); // number of all results found
result.addAll(queryResult.getResultList());



// read the tasks 
for (int i=0; i<result.size(); i++)
{
	ITask elementOfTasksITask = result.get(i);
	taskTree = new Tree(elementOfTasksITask , "ID");
	taskTree.setMayHaveChildren(false);
	out.treeLoadEvent.getTreeNode().add(taskTree);			
  
}// end for task' #txt
Ts0 f186 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f186 1038 1012 36 24 20 -2 #rect
Ts0 f186 @|RichDialogProcessStepIcon #fIcon
Ts0 f188 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f188 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f188 1042 770 28 28 14 0 #rect
Ts0 f188 @|AlternativeIcon #fIcon
Ts0 f190 expr in #txt
Ts0 f190 1070 784 1069 1120 #arcP
Ts0 f190 1 1416 784 #addKink
Ts0 f190 2 1416 1120 #addKink
Ts0 f190 1 0.21557090204391338 0 0 #arcLabel
Ts0 f162 expr out #txt
Ts0 f162 1056 746 1056 770 #arcP
Ts0 f20 expr out #txt
Ts0 f20 1056 1036 1056 1107 #arcP
Ts0 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Question dialog
continue loading all tasks?</name>
        <nameStyle>43,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f36 targetWindow NEW #txt
Ts0 f36 targetDisplay TOP #txt
Ts0 f36 richDialogId ch.ivyteam.ivy.addons.commondialogs.QuestionDialog #txt
Ts0 f36 startMethod askQuestionWithTitle(String,String,String,List<String>,String) #txt
Ts0 f36 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f36 panelName <%=in.confirmation%> #txt
Ts0 f36 requestActionDecl '<String icon, String questionTitle, String questionText, List<String> buttons, String defaultButton> param;' #txt
Ts0 f36 requestMappingAction 'param.buttons=["yes", "no"];
param.defaultButton="no";
' #txt
Ts0 f36 requestActionCode 'param.icon = "question";

param.questionTitle = 
			ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/confirmLoadAllTasksShortDesc");
			
param.questionText = 
			ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/confirmLoadAllTasksLongDesc");' #txt
Ts0 f36 responseActionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f36 responseMappingAction 'out=in;
out.questionDialogPressedButtonResult=result.pressedButton;
' #txt
Ts0 f36 windowConfiguration '#Wed Jan 21 17:24:05 CET 2009
height=200
maximized=false
centered=true
close_after_last_rd=true
resizable=true
width=550
title=<%\\=in.confirmation%>
' #txt
Ts0 f36 isAsynch false #txt
Ts0 f36 isInnerRd true #txt
Ts0 f36 isDialog true #txt
Ts0 f36 718 972 36 24 20 -2 #rect
Ts0 f36 @|RichDialogIcon #fIcon
Ts0 f55 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f55 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f55 722 1034 28 28 14 0 #rect
Ts0 f55 @|AlternativeIcon #fIcon
Ts0 f57 expr out #txt
Ts0 f57 736 996 736 1034 #arcP
Ts0 f58 expr in #txt
Ts0 f58 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>abort the load 
of all tasks</name>
        <nameStyle>28,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f58 750 1048 372 1311 #arcP
Ts0 f58 1 848 1048 #addKink
Ts0 f58 2 848 1296 #addKink
Ts0 f58 0 0.29646017699115046 0 0 #arcLabel
Ts0 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case process category name/
Case process name/
Business main contact name</name>
        <nameStyle>73,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f62 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f62 actionTable 'out=in;
' #txt
Ts0 f62 actionCode '// Case process category name/Case process name/Business main contact name


import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;


import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IGroup;

List<IGroup> caseProcessCategoriesIGroup;
List<IGroup> caseProcessesIGroup;
List<IGroup> businessMainContactsIGroup;


ITask elementOfCaseProcessCategoriesITask;
ITask elementOfCaseProcessesITask;
ITask elementOfBusinessMainContactsITask;



IPropertyFilter filter;

Tree rootTree = in.tasksHierarchyLayoutTree;
Tree caseProcessCategoryTree;
Tree caseProcessTree;
Tree businessMainContactTree;
List<Tree> parentsListOfTree = [];



if (in.sortByPriority)
{
	parentsListOfTree.addAll(rootTree.getChildren());
}
else
{
	parentsListOfTree.add(in.tasksHierarchyLayoutTree);
}


for(Tree currentParent: parentsListOfTree)
{
   TaskHierarchyTreeNodeValue currentPriorityNodeValue;

   if (currentParent.value instanceof TaskHierarchyTreeNodeValue)
   {
      // filter must consider the Property.PRIORITY
      currentPriorityNodeValue = currentParent.value as TaskHierarchyTreeNodeValue;
   }


	// consider the task states
	filter = in.taskStatesPropertyFilter;

	// consider the filter set by user
	if (in.filterEnabled)
	{
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}		

	// consider the priority sorting
	if (in.sortByPriority)
	{
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}	

	caseProcessCategoriesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, null, in.runningTaskMode, in.taskDisplayMode));


// read process categories
for (IGroup caseProcessCategory: caseProcessCategoriesIGroup)
{
   elementOfCaseProcessCategoriesITask = caseProcessCategory.getFirstObjectInGroup() as ITask;
   
   TaskHierarchyTreeNodeValue caseProcessCategoryTreeNodeValue = new TaskHierarchyTreeNodeValue();
   caseProcessCategoryTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE;
   caseProcessCategoryTreeNodeValue.categoryCode = elementOfCaseProcessCategoriesITask.getProcessCategoryCode();
   caseProcessCategoryTreeNodeValue.categoryName = (elementOfCaseProcessCategoriesITask.getProcessName() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryName(): 
					(elementOfCaseProcessCategoriesITask.getProcessCategoryCode() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryCode(): out.unclassifiedTasksTitle)) + " (" + caseProcessCategory.getNumberOfObjectsInGroup() + ")";

   caseProcessCategoryTree = currentParent.createChild(caseProcessCategoryTreeNodeValue, "PROCESS_CATEGORY_CODE");

   
   caseProcessesIGroup.clear();

   filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode());

		// consider the task states
		filter = filter.and(in.taskStatesPropertyFilter);
		
		// consider the filter set by user
		if (in.filterEnabled)
		{
			filter = filter.and(in.taskAvailableFilters.propertyFilter);
		}		

		// consider the priority sorting
		if (in.sortByPriority)
		{
			filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
		}

   caseProcessesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, null, in.runningTaskMode, in.taskDisplayMode));

   
   for (IGroup caseProcess: caseProcessesIGroup)
   {
      elementOfCaseProcessesITask = caseProcess.getFirstObjectInGroup() as ITask;

      TaskHierarchyTreeNodeValue caseProcessTreeNodeValue = new TaskHierarchyTreeNodeValue();
      caseProcessTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE;
      caseProcessTreeNodeValue.categoryCode = elementOfCaseProcessesITask.getProcessCode();
      caseProcessTreeNodeValue.categoryName = (elementOfCaseProcessesITask.getProcessName() is initialized? elementOfCaseProcessesITask.getProcessName(): caseProcessTreeNodeValue.categoryCode) + " (" + caseProcess.getNumberOfObjectsInGroup() + ")";
      caseProcessTree = caseProcessCategoryTree.createChild(caseProcessTreeNodeValue, "PROCESS_CODE");


      businessMainContactsIGroup.clear();

      filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                           ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessesITask.getProcessCode());

			// consider the task states
			filter = filter.and(in.taskStatesPropertyFilter);

			// consider the filter set by user
			if (in.filterEnabled)
			{
				filter = filter.and(in.taskAvailableFilters.propertyFilter);
			}		

			// consider the priority sorting
			if (in.sortByPriority)
			{
				filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
			}

      businessMainContactsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID, null, in.runningTaskMode, in.taskDisplayMode));


      for (IGroup businessMainContact: businessMainContactsIGroup)
      {
         elementOfBusinessMainContactsITask = businessMainContact.getFirstObjectInGroup() as ITask;

         TaskHierarchyTreeNodeValue businessMainContactTreeNodeValue = new TaskHierarchyTreeNodeValue();
         businessMainContactTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID;
         businessMainContactTreeNodeValue.categoryCode = (elementOfBusinessMainContactsITask.getBusinessMainContactId() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactId().toString(): null);
         businessMainContactTreeNodeValue.categoryName = (elementOfBusinessMainContactsITask.getBusinessMainContactName() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactName(): businessMainContactTreeNodeValue.categoryCode) + " (" + businessMainContact.getNumberOfObjectsInGroup() + ")";
         businessMainContactTree = caseProcessTree.createChild(businessMainContactTreeNodeValue,"BUSINESS_MAIN_CONTACT_ID");      

      }// end for bus main contacts

   }// end for processes

}// end for categories

}// end for priorities


out.tasksHierarchyLayoutTree = rootTree;' #txt
Ts0 f62 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f62 1094 404 36 24 20 -2 #rect
Ts0 f62 @|RichDialogProcessStepIcon #fIcon
Ts0 f63 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case process category name/
Business main contact name/
Case process name</name>
        <nameStyle>73,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f63 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f63 actionTable 'out=in;
' #txt
Ts0 f63 actionCode '// Case process category name/Business main contact name/Case process name


import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;


import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IGroup;

List<IGroup> caseProcessCategoriesIGroup;
List<IGroup> caseProcessesIGroup;
List<IGroup> businessMainContactsIGroup;


ITask elementOfCaseProcessCategoriesITask;
ITask elementOfCaseProcessesITask;
ITask elementOfBusinessMainContactsITask;



IPropertyFilter filter;

Tree rootTree = in.tasksHierarchyLayoutTree;
Tree caseProcessCategoryTree;
Tree caseProcessTree;
Tree businessMainContactTree;
List<Tree> parentsListOfTree = [];



if (in.sortByPriority)
{
	parentsListOfTree.addAll(rootTree.getChildren());
}
else
{
	parentsListOfTree.add(in.tasksHierarchyLayoutTree);
}


for(Tree currentParent: parentsListOfTree)
{
   TaskHierarchyTreeNodeValue currentPriorityNodeValue;

   if (currentParent.value instanceof TaskHierarchyTreeNodeValue)
   {
      // filter must consider the Property.PRIORITY
      currentPriorityNodeValue = currentParent.value as TaskHierarchyTreeNodeValue;
   }   


	// consider the task states
	filter = in.taskStatesPropertyFilter;

	// consider the filter set by user
	if (in.filterEnabled)
	{
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}		

	// consider the priority sorting
	if (in.sortByPriority)
	{
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}
	


	caseProcessCategoriesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, null, in.runningTaskMode, in.taskDisplayMode));


// read process categories
for (IGroup caseProcessCategory: caseProcessCategoriesIGroup)
{
   elementOfCaseProcessCategoriesITask = caseProcessCategory.getFirstObjectInGroup() as ITask;
   
   TaskHierarchyTreeNodeValue caseProcessCategoryTreeNodeValue = new TaskHierarchyTreeNodeValue();
   caseProcessCategoryTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE;
   caseProcessCategoryTreeNodeValue.categoryCode = elementOfCaseProcessCategoriesITask.getProcessCategoryCode();
   caseProcessCategoryTreeNodeValue.categoryName = (elementOfCaseProcessCategoriesITask.getProcessName() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryName(): 
					(elementOfCaseProcessCategoriesITask.getProcessCategoryCode() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryCode(): out.unclassifiedTasksTitle)) + " (" + caseProcessCategory.getNumberOfObjectsInGroup() + ")";

   caseProcessCategoryTree = currentParent.createChild(caseProcessCategoryTreeNodeValue, "PROCESS_CATEGORY_CODE");

   
   businessMainContactsIGroup.clear();

   filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode());

		// consider the task states
		filter = filter.and(in.taskStatesPropertyFilter);

		// consider the filter set by user
		if (in.filterEnabled)
		{
			filter = filter.and(in.taskAvailableFilters.propertyFilter);
		}		

		// consider the priority sorting
		if (in.sortByPriority)
		{
			filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
		}


   businessMainContactsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID, null, in.runningTaskMode, in.taskDisplayMode));


   for (IGroup businessMainContact: businessMainContactsIGroup)
   {
      elementOfBusinessMainContactsITask = businessMainContact.getFirstObjectInGroup() as ITask;

      TaskHierarchyTreeNodeValue businessMainContactTreeNodeValue = new TaskHierarchyTreeNodeValue();
      businessMainContactTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID;
      businessMainContactTreeNodeValue.categoryCode = (elementOfBusinessMainContactsITask.getBusinessMainContactId() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactId().toString(): null) ;
      businessMainContactTreeNodeValue.categoryName = (elementOfBusinessMainContactsITask.getBusinessMainContactName() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactName(): businessMainContactTreeNodeValue.categoryCode) + " (" + businessMainContact.getNumberOfObjectsInGroup() + ")";
      businessMainContactTree = caseProcessCategoryTree.createChild(businessMainContactTreeNodeValue,"BUSINESS_MAIN_CONTACT_ID");      


      caseProcessesIGroup.clear();

      filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                           ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessMainContactsITask.getBusinessMainContactId());

			// consider the task states
			filter = filter.and(in.taskStatesPropertyFilter);

			// consider the filter set by user
			if (in.filterEnabled)
			{
				filter = filter.and(in.taskAvailableFilters.propertyFilter);
			}		

			// consider the priority sorting
			if (in.sortByPriority)
			{
				filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
			}

      caseProcessesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, null, in.runningTaskMode, in.taskDisplayMode));

   
      for (IGroup caseProcess: caseProcessesIGroup)
      {
         elementOfCaseProcessesITask = caseProcess.getFirstObjectInGroup() as ITask;

         TaskHierarchyTreeNodeValue caseProcessTreeNodeValue = new TaskHierarchyTreeNodeValue();
         caseProcessTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE;
         caseProcessTreeNodeValue.categoryCode = elementOfCaseProcessesITask.getProcessCode();
         caseProcessTreeNodeValue.categoryName = (elementOfCaseProcessesITask.getProcessName() is initialized? elementOfCaseProcessesITask.getProcessName(): caseProcessTreeNodeValue.categoryCode) + " (" + caseProcess.getNumberOfObjectsInGroup() + ")";
         caseProcessTree = businessMainContactTree.createChild(caseProcessTreeNodeValue, "PROCESS_CODE");

      }// end for processes
   }// end for bus main contacts
}// end for categories
}// end for priorities

out.tasksHierarchyLayoutTree = rootTree;' #txt
Ts0 f63 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f63 1310 404 36 24 20 -2 #rect
Ts0 f63 @|RichDialogProcessStepIcon #fIcon
Ts0 f70 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case process category name/
BUSINESS_START_TIMESTAMP/ 
Business main contact name/
Case process name</name>
        <nameStyle>100,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f70 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f70 actionTable 'out=in;
' #txt
Ts0 f70 actionCode '// Case process category name / BUSINESS_START_TIMESTAMP/ Business main contact name/Case process name


import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;


import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IGroup;


List<IGroup> caseProcessCategoriesIGroup;
List<IGroup> businessStartTimeStampsIGroup;
List<IGroup> businessMainContactsIGroup;
List<IGroup> caseProcessesIGroup;


ITask elementOfCaseProcessCategoriesITask;
ITask elementOfBusinessStartTimeStampsITask;
ITask elementOfBusinessMainContactsITask;
ITask elementOfCaseProcessesITask;


IPropertyFilter filter;

Tree rootTree = in.tasksHierarchyLayoutTree;
Tree caseProcessCategoryTree;
Tree businessStartTimeStampTree;
Tree businessMainContactTree;
Tree caseProcessTree;
List<Tree> parentsListOfTree = [];


if (in.sortByPriority)
{
	parentsListOfTree.addAll(rootTree.getChildren());
}
else
{
	parentsListOfTree.add(in.tasksHierarchyLayoutTree);
}



for(Tree currentParent: parentsListOfTree)
{
   TaskHierarchyTreeNodeValue currentPriorityNodeValue;

   if (currentParent.value instanceof TaskHierarchyTreeNodeValue)
   {
      // filter must consider the Property.PRIORITY
      currentPriorityNodeValue = currentParent.value as TaskHierarchyTreeNodeValue;
   }   

	// consider the task states
	filter = in.taskStatesPropertyFilter;

	// consider the filter set by user
	if (in.filterEnabled)
	{
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}		

	// consider the priority sorting
	if (in.sortByPriority)
	{
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}	

	caseProcessCategoriesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, null, in.runningTaskMode, in.taskDisplayMode));


// read process categories
for (IGroup caseProcessCategory: caseProcessCategoriesIGroup)
{
   elementOfCaseProcessCategoriesITask = caseProcessCategory.getFirstObjectInGroup() as ITask;


   TaskHierarchyTreeNodeValue caseProcessCategoryTreeNodeValue = new TaskHierarchyTreeNodeValue();
   caseProcessCategoryTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE;
   caseProcessCategoryTreeNodeValue.categoryCode = elementOfCaseProcessCategoriesITask.getProcessCategoryCode();
   caseProcessCategoryTreeNodeValue.categoryName = (elementOfCaseProcessCategoriesITask.getProcessName() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryName(): 
					(elementOfCaseProcessCategoriesITask.getProcessCategoryCode() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryCode(): out.unclassifiedTasksTitle)) + " (" + caseProcessCategory.getNumberOfObjectsInGroup() + ")";

   caseProcessCategoryTree = currentParent.createChild(caseProcessCategoryTreeNodeValue, "PROCESS_CATEGORY_CODE");


   businessStartTimeStampsIGroup.clear();

   filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode());

		// consider the task states
		filter = filter.and(in.taskStatesPropertyFilter);

		// consider the filter set by user
		if (in.filterEnabled)
		{
			filter = filter.and(in.taskAvailableFilters.propertyFilter);
		}		

		// consider the priority sorting
		if (in.sortByPriority)
		{
			filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
		}	

   businessStartTimeStampsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, null, in.runningTaskMode, in.taskDisplayMode));


   for (IGroup businessStartTimeStamp: businessStartTimeStampsIGroup)
   {
      elementOfBusinessStartTimeStampsITask = businessStartTimeStamp.getFirstObjectInGroup() as ITask;

      TaskHierarchyTreeNodeValue businessStartTimeStampTreeNodeValue = new TaskHierarchyTreeNodeValue();
      businessStartTimeStampTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP;
      businessStartTimeStampTreeNodeValue.categoryCode = (elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp() is initialized? elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp().toString(): null);
      businessStartTimeStampTreeNodeValue.categoryName = (elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp() is initialized? new DateTime(elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp()).format("medium"): "") + " (" + businessStartTimeStamp.getNumberOfObjectsInGroup() + ")";
      businessStartTimeStampTree = caseProcessCategoryTree.createChild(businessStartTimeStampTreeNodeValue,"BUSINESS_START_TIMESTAMP");

   
      businessMainContactsIGroup.clear();

      filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                           ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp());

			// consider the task states
			filter = filter.and(in.taskStatesPropertyFilter);
	
			// consider the filter set by user
			if (in.filterEnabled)
			{
				filter = filter.and(in.taskAvailableFilters.propertyFilter);
			}		

			// consider the priority sorting
			if (in.sortByPriority)
			{
				filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
			}	

      businessMainContactsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID, null, in.runningTaskMode, in.taskDisplayMode));


      for (IGroup businessMainContact: businessMainContactsIGroup)
      {
         elementOfBusinessMainContactsITask = businessMainContact.getFirstObjectInGroup() as ITask;
   
         TaskHierarchyTreeNodeValue businessMainContactTreeNodeValue = new TaskHierarchyTreeNodeValue();
         businessMainContactTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID;
         businessMainContactTreeNodeValue.categoryCode = (elementOfBusinessMainContactsITask.getBusinessMainContactId() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactId().toString(): null) ;
         businessMainContactTreeNodeValue.categoryName = (elementOfBusinessMainContactsITask.getBusinessMainContactName() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactName(): businessMainContactTreeNodeValue.categoryCode) + " (" + businessMainContact.getNumberOfObjectsInGroup() + ")";
         businessMainContactTree = businessStartTimeStampTree.createChild(businessMainContactTreeNodeValue,"BUSINESS_MAIN_CONTACT_ID");      


         caseProcessesIGroup.clear();

         filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                              ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp()).and(
                                                                                 ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessMainContactsITask.getBusinessMainContactId());

					// consider the task states
					filter = filter.and(in.taskStatesPropertyFilter);

					// consider the filter set by user
					if (in.filterEnabled)
					{
						filter = filter.and(in.taskAvailableFilters.propertyFilter);
					}		

					// consider the priority sorting
					if (in.sortByPriority)
					{
						filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
					}	
         
         caseProcessesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, null, in.runningTaskMode, in.taskDisplayMode));

   
         for (IGroup caseProcess: caseProcessesIGroup)
         {
            elementOfCaseProcessesITask = caseProcess.getFirstObjectInGroup() as ITask;

            TaskHierarchyTreeNodeValue caseProcessTreeNodeValue = new TaskHierarchyTreeNodeValue();
            caseProcessTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE;
            caseProcessTreeNodeValue.categoryCode = elementOfCaseProcessesITask.getProcessCode();
            caseProcessTreeNodeValue.categoryName = (elementOfCaseProcessesITask.getProcessName() is initialized? elementOfCaseProcessesITask.getProcessName(): caseProcessTreeNodeValue.categoryCode) + " (" + caseProcess.getNumberOfObjectsInGroup() + ")";
            caseProcessTree = businessMainContactTree.createChild(caseProcessTreeNodeValue, "PROCESS_CODE");

         }// end for processes
      }// end for bus main contacts
   }// end for bus start time stamps
}// end for categories

}// end for priorities

out.tasksHierarchyLayoutTree = rootTree;' #txt
Ts0 f70 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f70 1534 404 36 24 20 -2 #rect
Ts0 f70 @|RichDialogProcessStepIcon #fIcon
Ts0 f82 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case process category name/
BUSINESS_START_TIMESTAMP/ 
Case process name/
Business main contact name</name>
        <nameStyle>100,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f82 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f82 actionTable 'out=in;
' #txt
Ts0 f82 actionCode '// Case process category name / BUSINESS_START_TIMESTAMP / Case process name / Business main contact name


import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;


import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IGroup;


List<IGroup> caseProcessCategoriesIGroup;
List<IGroup> businessStartTimeStampsIGroup;
List<IGroup> caseProcessesIGroup;
List<IGroup> businessMainContactsIGroup;


ITask elementOfCaseProcessCategoriesITask;
ITask elementOfBusinessStartTimeStampsITask;
ITask elementOfCaseProcessesITask;
ITask elementOfBusinessMainContactsITask;


IPropertyFilter filter;


Tree rootTree = in.tasksHierarchyLayoutTree;
Tree caseProcessCategoryTree;
Tree businessStartTimeStampTree;
Tree caseProcessTree;
Tree businessMainContactTree;
List<Tree> parentsListOfTree = [];



if (in.sortByPriority)
{
	parentsListOfTree.addAll(rootTree.getChildren());
}
else
{
	parentsListOfTree.add(in.tasksHierarchyLayoutTree);
}


for(Tree currentParent: parentsListOfTree)
{
   TaskHierarchyTreeNodeValue currentPriorityNodeValue;

   if (currentParent.value instanceof TaskHierarchyTreeNodeValue)
   {
      // filter must consider the Property.PRIORITY
      currentPriorityNodeValue = currentParent.value as TaskHierarchyTreeNodeValue;
   }   

	// consider the task states
	filter = in.taskStatesPropertyFilter;

	// consider the filter set by user
	if (in.filterEnabled)
	{
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}		

	// consider the priority sorting
	if (in.sortByPriority)
	{
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}

	caseProcessCategoriesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, null, in.runningTaskMode, in.taskDisplayMode));




// read process categories
for (IGroup caseProcessCategory: caseProcessCategoriesIGroup)
{
   elementOfCaseProcessCategoriesITask = caseProcessCategory.getFirstObjectInGroup() as ITask;


   TaskHierarchyTreeNodeValue caseProcessCategoryTreeNodeValue = new TaskHierarchyTreeNodeValue();
   caseProcessCategoryTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE;
   caseProcessCategoryTreeNodeValue.categoryCode = elementOfCaseProcessCategoriesITask.getProcessCategoryCode();
   caseProcessCategoryTreeNodeValue.categoryName = (elementOfCaseProcessCategoriesITask.getProcessName() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryName(): 
					(elementOfCaseProcessCategoriesITask.getProcessCategoryCode() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryCode(): out.unclassifiedTasksTitle)) + " (" + caseProcessCategory.getNumberOfObjectsInGroup() + ")";

   caseProcessCategoryTree = currentParent.createChild(caseProcessCategoryTreeNodeValue, "PROCESS_CATEGORY_CODE");


   businessStartTimeStampsIGroup.clear();

   filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode());

		// consider the task states
		filter = filter.and(in.taskStatesPropertyFilter);

		// consider the filter set by user
		if (in.filterEnabled)
		{
			filter = filter.and(in.taskAvailableFilters.propertyFilter);
		}		

		// consider the priority sorting
		if (in.sortByPriority)
		{
			filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
		}

   businessStartTimeStampsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, null, in.runningTaskMode, in.taskDisplayMode));


   for (IGroup businessStartTimeStamp: businessStartTimeStampsIGroup)
   {
      elementOfBusinessStartTimeStampsITask = businessStartTimeStamp.getFirstObjectInGroup() as ITask;

      TaskHierarchyTreeNodeValue businessStartTimeStampTreeNodeValue = new TaskHierarchyTreeNodeValue();
      businessStartTimeStampTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP;
      businessStartTimeStampTreeNodeValue.categoryCode = (elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp() is initialized? elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp().toString(): null);
      businessStartTimeStampTreeNodeValue.categoryName = (elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp() is initialized? new DateTime(elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp()).format("medium"): "") + " (" + businessStartTimeStamp.getNumberOfObjectsInGroup() + ")";
      businessStartTimeStampTree = caseProcessCategoryTree.createChild(businessStartTimeStampTreeNodeValue,"BUSINESS_START_TIMESTAMP");
   

      caseProcessesIGroup.clear();

      filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                           ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp());

			// consider the task states
			filter = filter.and(in.taskStatesPropertyFilter);

			// consider the filter set by user
			if (in.filterEnabled)
			{
				filter = filter.and(in.taskAvailableFilters.propertyFilter);
			}		

			// consider the priority sorting
			if (in.sortByPriority)
			{
				filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
			}

      caseProcessesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, null, in.runningTaskMode, in.taskDisplayMode));

   
      for (IGroup caseProcess: caseProcessesIGroup)
      {
         elementOfCaseProcessesITask = caseProcess.getFirstObjectInGroup() as ITask;

         TaskHierarchyTreeNodeValue caseProcessTreeNodeValue = new TaskHierarchyTreeNodeValue();
         caseProcessTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE;
         caseProcessTreeNodeValue.categoryCode = elementOfCaseProcessesITask.getProcessCode();
         caseProcessTreeNodeValue.categoryName = (elementOfCaseProcessesITask.getProcessName() is initialized? elementOfCaseProcessesITask.getProcessName(): caseProcessTreeNodeValue.categoryCode) + " (" + caseProcess.getNumberOfObjectsInGroup() + ")";
         caseProcessTree = businessStartTimeStampTree.createChild(caseProcessTreeNodeValue, "PROCESS_CODE");

         businessMainContactsIGroup.clear();

         filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                              ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp()).and(
                                                                                 ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessesITask.getProcessCode());
					// consider the task states
					filter = filter.and(in.taskStatesPropertyFilter);
					

					// consider the filter set by user
					if (in.filterEnabled)
					{
						filter = filter.and(in.taskAvailableFilters.propertyFilter);
					}		

					// consider the priority sorting
					if (in.sortByPriority)
					{
						filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
					}

         businessMainContactsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID, null, in.runningTaskMode, in.taskDisplayMode));


         for (IGroup businessMainContact: businessMainContactsIGroup)
         {
            elementOfBusinessMainContactsITask = businessMainContact.getFirstObjectInGroup() as ITask;
   
            TaskHierarchyTreeNodeValue businessMainContactTreeNodeValue = new TaskHierarchyTreeNodeValue();
            businessMainContactTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_ID;
            businessMainContactTreeNodeValue.categoryCode = (elementOfBusinessMainContactsITask.getBusinessMainContactId() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactId().toString(): null) ;
            businessMainContactTreeNodeValue.categoryName = (elementOfBusinessMainContactsITask.getBusinessMainContactName() is initialized? elementOfBusinessMainContactsITask.getBusinessMainContactName(): businessMainContactTreeNodeValue.categoryCode) + " (" + businessMainContact.getNumberOfObjectsInGroup() + ")";
            businessMainContactTree = caseProcessTree.createChild(businessMainContactTreeNodeValue,"BUSINESS_MAIN_CONTACT_ID");      

        }// end for bus main contacts
      }// end for processes
   }// end for bus start time stamps
}// end for categories

}// end for priorities


out.tasksHierarchyLayoutTree = rootTree;' #txt
Ts0 f82 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f82 1782 404 36 24 20 -2 #rect
Ts0 f82 @|RichDialogProcessStepIcon #fIcon
Ts0 f156 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case process category/
Case process/
Case type/
Task stage</name>
        <nameStyle>58,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f156 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f156 actionTable 'out=in;
' #txt
Ts0 f156 actionCode '// Case Process Category name/Case process name/Case type name/Task stage name

import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;


import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IGroup;

List<IGroup> caseProcessCategoriesIGroup;
List<IGroup> caseProcessesIGroup;
List<IGroup> caseTypesIGroup;
List<IGroup> taskKindsIGroup;

ITask elementOfCaseProcessCategoriesITask;
ITask elementOfCaseProcessesITask;
ITask elementOfCaseTypesITask;
ITask elementOfTaskKindsITask;


IPropertyFilter filter;

Tree rootTree = in.tasksHierarchyLayoutTree;
Tree caseProcessCategoryTree;
Tree caseProcessTree;
Tree caseTypeTree;
Tree taskKindTree;
List<Tree> parentsListOfTree = [];



if (in.sortByPriority)
{
	parentsListOfTree.addAll(rootTree.getChildren());
}
else
{
	parentsListOfTree.add(in.tasksHierarchyLayoutTree);
}



for(Tree currentParent: parentsListOfTree)
{
   TaskHierarchyTreeNodeValue currentPriorityNodeValue;

   if (currentParent.value instanceof TaskHierarchyTreeNodeValue)
   {
      // filter must consider the Property.PRIORITY
      currentPriorityNodeValue = currentParent.value as TaskHierarchyTreeNodeValue;
   }


	caseProcessCategoriesIGroup.clear();

	// consider the task states
	filter = in.taskStatesPropertyFilter;

	// consider the filter set by user
	if (in.filterEnabled)
	{
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}		
	
	// consider the priority sorting
	if (in.sortByPriority)
	{
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}	
	
	
	caseProcessCategoriesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, null, in.runningTaskMode, in.taskDisplayMode));


// read process categories
for (IGroup caseProcessCategory: caseProcessCategoriesIGroup)
{
   elementOfCaseProcessCategoriesITask = caseProcessCategory.getFirstObjectInGroup() as ITask;
   
   TaskHierarchyTreeNodeValue processCategoryTreeNodeValue = new TaskHierarchyTreeNodeValue();
   processCategoryTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE;
   processCategoryTreeNodeValue.categoryCode = elementOfCaseProcessCategoriesITask.getProcessCategoryCode();
   processCategoryTreeNodeValue.categoryName = (elementOfCaseProcessCategoriesITask.getProcessName() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryName(): 
					(elementOfCaseProcessCategoriesITask.getProcessCategoryCode() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryCode(): out.unclassifiedTasksTitle)) + " (" + caseProcessCategory.getNumberOfObjectsInGroup() + ")";

   caseProcessCategoryTree = currentParent.createChild(processCategoryTreeNodeValue, "PROCESS_CATEGORY_CODE");
   
   caseProcessesIGroup.clear();
      
   filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode());

		// consider the task states
		filter = filter.and(in.taskStatesPropertyFilter);
		
		// consider the filter set by user
		if (in.filterEnabled)
		{
			filter = filter.and(in.taskAvailableFilters.propertyFilter);
		}		

		// consider the priority sorting
		if (in.sortByPriority)
		{
			filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
		}		


   caseProcessesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, null, in.runningTaskMode, in.taskDisplayMode));

   // read process names of the given caseProcessCategory
   for (IGroup caseProcess: caseProcessesIGroup)
   {
      elementOfCaseProcessesITask = caseProcess.getFirstObjectInGroup() as ITask;

      TaskHierarchyTreeNodeValue caseProcessTreeNodeValue = new TaskHierarchyTreeNodeValue();
      caseProcessTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE;
      caseProcessTreeNodeValue.categoryCode = elementOfCaseProcessesITask.getProcessCode();
      caseProcessTreeNodeValue.categoryName = (elementOfCaseProcessesITask.getProcessName() is initialized? elementOfCaseProcessesITask.getProcessName(): caseProcessTreeNodeValue.categoryCode) + " (" + caseProcess.getNumberOfObjectsInGroup() + ")";
      caseProcessTree = caseProcessCategoryTree.createChild(caseProcessTreeNodeValue, "PROCESS_CODE");

      caseTypesIGroup.clear();

      filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                           ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE,ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessesITask.getProcessCode());

			// consider the task states
			filter = filter.and(in.taskStatesPropertyFilter);

			// consider the filter set by user
			if (in.filterEnabled)
			{
				filter = filter.and(in.taskAvailableFilters.propertyFilter);
			}		

			// consider the priority sorting
			if (in.sortByPriority)
			{
				filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
			}	


      caseTypesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.TYPE_CODE, null, in.runningTaskMode, in.taskDisplayMode));
      
      // read type name of the process names of the given caseProcessCategory
      for (IGroup caseType: caseTypesIGroup)
      {
         elementOfCaseTypesITask = caseType.getFirstObjectInGroup() as ITask;

         TaskHierarchyTreeNodeValue caseTypeTreeNodeValue = new TaskHierarchyTreeNodeValue();
         caseTypeTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.TYPE_CODE;
         caseTypeTreeNodeValue.categoryCode = elementOfCaseTypesITask.getTypeCode();
         caseTypeTreeNodeValue.categoryName = (elementOfCaseTypesITask.getTypeName() is initialized? elementOfCaseTypesITask.getTypeName(): caseTypeTreeNodeValue.categoryCode) + " (" + caseType.getNumberOfObjectsInGroup() + ")";
         caseTypeTree = caseProcessTree.createChild(caseTypeTreeNodeValue,"TYPE_CODE");

         taskKindsIGroup.clear();

         filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                              ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessesITask.getProcessCode()).and(
                                                                                 ch.ivyteam.ivy.workflow.TaskProperty.TYPE_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseTypesITask.getTypeCode()); 

				// consider the task states
				filter = filter.and(in.taskStatesPropertyFilter);
				
				// consider the filter set by user
				if (in.filterEnabled)
				{
					filter = filter.and(in.taskAvailableFilters.propertyFilter);
				}		

				// consider the priority sorting
				if (in.sortByPriority)
				{
					filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
				}	


         taskKindsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.KIND_CODE, null, in.runningTaskMode, in.taskDisplayMode));

         // read the subtype of the given type name of the given process names of the given caseProcessCategory         
         for (IGroup taskKind: taskKindsIGroup)
         {
            elementOfTaskKindsITask = taskKind.getFirstObjectInGroup() as ITask;

            TaskHierarchyTreeNodeValue taskKindTreeNodeValue = new TaskHierarchyTreeNodeValue();
            taskKindTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.KIND_CODE;
            taskKindTreeNodeValue.categoryCode = elementOfTaskKindsITask.getKindCode();
            taskKindTreeNodeValue.categoryName = (elementOfTaskKindsITask.getKindName() is initialized? elementOfTaskKindsITask.getKindName(): taskKindTreeNodeValue.categoryCode) + " (" + taskKind.getNumberOfObjectsInGroup() + ")";
            taskKindTree = caseTypeTree.createChild(taskKindTreeNodeValue,"KIND_CODE");

            }// end for sub types
      }// end for types      
   }// end for processes
}// end for categories

}// end for priorities' #txt
Ts0 f156 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f156 894 404 36 24 20 -2 #rect
Ts0 f156 @|RichDialogProcessStepIcon #fIcon
Ts0 f157 expr in #txt
Ts0 f157 outCond 'in.taskHierarchyLayoutSelectedIndex == 1' #txt
Ts0 f157 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f157 1315 321 912 404 #arcP
Ts0 f157 1 912 336 #addKink
Ts0 f157 1 2.3684757858670006E-16 0 0 #arcLabel
Ts0 f158 expr in #txt
Ts0 f158 outCond 'in.taskHierarchyLayoutSelectedIndex == 2' #txt
Ts0 f158 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f158 1315 321 1112 404 #arcP
Ts0 f158 1 1112 344 #addKink
Ts0 f158 0 0.6158242954976134 0 1 #arcLabel
Ts0 f159 expr in #txt
Ts0 f159 outCond 'in.taskHierarchyLayoutSelectedIndex == 3' #txt
Ts0 f159 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f159 1328 334 1328 404 #arcP
Ts0 f159 0 0.6331511807766471 -12 1 #arcLabel
Ts0 f160 expr in #txt
Ts0 f160 outCond 'in.taskHierarchyLayoutSelectedIndex == 4' #txt
Ts0 f160 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f160 1341 321 1552 404 #arcP
Ts0 f160 1 1552 344 #addKink
Ts0 f160 0 0.9694448719158568 -1 21 #arcLabel
Ts0 f161 expr in #txt
Ts0 f161 outCond 'in.taskHierarchyLayoutSelectedIndex == 5' #txt
Ts0 f161 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f161 1342 320 1800 404 #arcP
Ts0 f161 1 1800 336 #addKink
Ts0 f161 0 0.9797069273511949 0 14 #arcLabel
Ts0 f177 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case process category name/
Business creator user/
Business start time stamp/
Case process name</name>
        <nameStyle>95,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f177 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f177 actionTable 'out=in;
' #txt
Ts0 f177 actionCode '// Case process category name / Business creator user/ Business start time stamp / Case process name


import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;


import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IGroup;


List<IGroup> caseProcessCategoriesIGroup;
List<IGroup> businessCreatorUsersIGroup;
List<IGroup> businessStartTimeStampsIGroup;
List<IGroup> caseProcessesIGroup;



ITask elementOfCaseProcessCategoriesITask;
ITask elementOfBusinessCreatorUsersITask;
ITask elementOfBusinessStartTimeStampsITask;
ITask elementOfCaseProcessesITask;



IPropertyFilter filter;


Tree rootTree = in.tasksHierarchyLayoutTree;
Tree caseProcessCategoryTree;
Tree businessCreatorUserTree;
Tree businessStartTimeStampTree;
Tree caseProcessTree;
List<Tree> parentsListOfTree = [];


if (in.sortByPriority)
{
	parentsListOfTree.addAll(rootTree.getChildren());
}
else
{
	parentsListOfTree.add(in.tasksHierarchyLayoutTree);	
}


for(Tree currentParent: parentsListOfTree)
{
   TaskHierarchyTreeNodeValue currentPriorityNodeValue;

   if (currentParent.value instanceof TaskHierarchyTreeNodeValue)
   {
      // filter must consider the Property.PRIORITY
      currentPriorityNodeValue = currentParent.value as TaskHierarchyTreeNodeValue;
   }   

	// consider the task states
	filter = in.taskStatesPropertyFilter;

	// consider the filter set by user
	if (in.filterEnabled)
	{
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}		

	// consider the priority sorting
	if (in.sortByPriority)
	{
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}


	caseProcessCategoriesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, null, in.runningTaskMode, in.taskDisplayMode));




// read process categories
for (IGroup caseProcessCategory: caseProcessCategoriesIGroup)
{
   elementOfCaseProcessCategoriesITask = caseProcessCategory.getFirstObjectInGroup() as ITask;

   TaskHierarchyTreeNodeValue caseProcessCategoryTreeNodeValue = new TaskHierarchyTreeNodeValue();
   caseProcessCategoryTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE;
   caseProcessCategoryTreeNodeValue.categoryCode = elementOfCaseProcessCategoriesITask.getProcessCategoryCode();
   caseProcessCategoryTreeNodeValue.categoryName = (elementOfCaseProcessCategoriesITask.getProcessName() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryName(): 
					(elementOfCaseProcessCategoriesITask.getProcessCategoryCode() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryCode(): out.unclassifiedTasksTitle)) + " (" + caseProcessCategory.getNumberOfObjectsInGroup() + ")";

   caseProcessCategoryTree = currentParent.createChild(caseProcessCategoryTreeNodeValue, "PROCESS_CATEGORY_CODE");


   businessCreatorUsersIGroup.clear();

   filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode());

		// consider the task states
		filter = filter.and(in.taskStatesPropertyFilter);

		// consider the filter set by user
		if (in.filterEnabled)
		{
			filter = filter.and(in.taskAvailableFilters.propertyFilter);
		}		

		// consider the priority sorting
		if (in.sortByPriority)
		{
			filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
		}
	
   businessCreatorUsersIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_CREATOR_USER, null, in.runningTaskMode, in.taskDisplayMode));

   for (IGroup businessCreatorUser: businessCreatorUsersIGroup)
   {
      elementOfBusinessCreatorUsersITask = businessCreatorUser.getFirstObjectInGroup() as ITask;

      TaskHierarchyTreeNodeValue businessCreatorUserTreeNodeValue = new TaskHierarchyTreeNodeValue();
      businessCreatorUserTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_CREATOR_USER;
      businessCreatorUserTreeNodeValue.categoryCode = elementOfBusinessCreatorUsersITask.getBusinessCreatorUser();
      businessCreatorUserTreeNodeValue.categoryName = businessCreatorUserTreeNodeValue.categoryCode + " (" + businessCreatorUser.getNumberOfObjectsInGroup() + ")";
      businessCreatorUserTree = caseProcessCategoryTree.createChild(businessCreatorUserTreeNodeValue,"BUSINESS_CREATOR_USER");



      businessStartTimeStampsIGroup.clear();

      filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                           ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_CREATOR_USER, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessCreatorUsersITask.getBusinessCreatorUser());

			// consider the task states
			filter = filter.and(in.taskStatesPropertyFilter);

			// consider the filter set by user
			if (in.filterEnabled)
			{
				filter = filter.and(in.taskAvailableFilters.propertyFilter);
			}		

			// consider the priority sorting
			if (in.sortByPriority)
			{
				filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
			}
		
      businessStartTimeStampsIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, null, in.runningTaskMode, in.taskDisplayMode));


      for (IGroup businessStartTimeStamp: businessStartTimeStampsIGroup)
      {
         elementOfBusinessStartTimeStampsITask = businessStartTimeStamp.getFirstObjectInGroup() as ITask;

         TaskHierarchyTreeNodeValue businessStartTimeStampTreeNodeValue = new TaskHierarchyTreeNodeValue();
         businessStartTimeStampTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP;
         businessStartTimeStampTreeNodeValue.categoryCode = (elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp() is initialized? elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp().toString(): null);
         businessStartTimeStampTreeNodeValue.categoryName = (elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp() is initialized? new DateTime(elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp()).format("medium"): "") + " (" + businessStartTimeStamp.getNumberOfObjectsInGroup() + ")";
         businessStartTimeStampTree = businessCreatorUserTree.createChild(businessStartTimeStampTreeNodeValue,"BUSINESS_START_TIMESTAMP");
   

         caseProcessesIGroup.clear();

         filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                              ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_CREATOR_USER, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessCreatorUsersITask.getBusinessCreatorUser()).and(
                                                                                 ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_START_TIMESTAMP, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfBusinessStartTimeStampsITask.getBusinessStartTimestamp());
				// consider the task states
				filter = filter.and(in.taskStatesPropertyFilter);


				// consider the filter set by user
				if (in.filterEnabled)
				{
					filter = filter.and(in.taskAvailableFilters.propertyFilter);
				}		

				// consider the priority sorting
				if (in.sortByPriority)
				{
					filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
				}
				
         caseProcessesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, null, in.runningTaskMode, in.taskDisplayMode));

   
         for (IGroup caseProcess: caseProcessesIGroup)
         {
            elementOfCaseProcessesITask = caseProcess.getFirstObjectInGroup() as ITask;

            TaskHierarchyTreeNodeValue caseProcessTreeNodeValue = new TaskHierarchyTreeNodeValue();
            caseProcessTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE;
            caseProcessTreeNodeValue.categoryCode = elementOfCaseProcessesITask.getProcessCode();
            caseProcessTreeNodeValue.categoryName = (elementOfCaseProcessesITask.getProcessName() is initialized? elementOfCaseProcessesITask.getProcessName(): caseProcessTreeNodeValue.categoryCode) + " (" + caseProcess.getNumberOfObjectsInGroup() + ")";
            caseProcessTree = businessStartTimeStampTree.createChild(caseProcessTreeNodeValue, "PROCESS_CODE");
      
         }// end for case processes
      }// end for bus start time stamps
   }// end for bus creator users
}// end for case process categories

}// end for priorities


out.tasksHierarchyLayoutTree = rootTree;' #txt
Ts0 f177 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f177 2022 404 36 24 20 -2 #rect
Ts0 f177 @|RichDialogProcessStepIcon #fIcon
Ts0 f178 expr in #txt
Ts0 f178 outCond 'in.taskHierarchyLayoutSelectedIndex == 6' #txt
Ts0 f178 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f178 1342 320 2040 404 #arcP
Ts0 f178 1 2040 320 #addKink
Ts0 f178 0 0.9203354898719135 0 -10 #arcLabel
Ts0 f23 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Case process category name/
Case process name/
Case type name/
Case sub type name</name>
        <nameStyle>81,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f23 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f23 actionTable 'out=in;
' #txt
Ts0 f23 actionCode 'import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;


import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IGroup;

List<IGroup> caseProcessCategoriesIGroup;
List<IGroup> caseProcessesIGroup;
List<IGroup> caseTypesIGroup;
List<IGroup> caseSubTypesIGroup;

ITask elementOfCaseProcessCategoriesITask;
ITask elementOfCaseProcessesITask;
ITask elementOfCaseTypesITask;
ITask elementOfCaseSubTypesITask;


IPropertyFilter filter;

Tree rootTree = in.tasksHierarchyLayoutTree;
Tree caseProcessCategoryTree;
Tree caseProcessTree;
Tree caseTypeTree;
Tree caseSubTypeTree;
List<Tree> parentsListOfTree;		// list of priorities nodes or just root node




parentsListOfTree = [];

if (in.sortByPriority)
{
	parentsListOfTree.addAll(rootTree.getChildren());
}
else
{
	parentsListOfTree.add(in.tasksHierarchyLayoutTree);
}


for(Tree currentParent: parentsListOfTree)
{
   TaskHierarchyTreeNodeValue currentPriorityNodeValue;

   if (currentParent.value instanceof TaskHierarchyTreeNodeValue)
   {
      // filter must consider the Property.PRIORITY
      currentPriorityNodeValue = currentParent.value as TaskHierarchyTreeNodeValue;
   }


	caseProcessCategoriesIGroup.clear();
	
	// consider the task states
	filter = in.taskStatesPropertyFilter;
	
	// consider the filter set by user
	if (in.filterEnabled)
	{
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}
	
	// consider the priority sorting
	if (in.sortByPriority)
	{
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}
	
	
	caseProcessCategoriesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(
																																				filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, 
																																				null, in.runningTaskMode, in.taskDisplayMode));	


// read process categories
for (IGroup caseProcessCategory: caseProcessCategoriesIGroup)
{
   elementOfCaseProcessCategoriesITask = caseProcessCategory.getFirstObjectInGroup() as ITask;
   
   TaskHierarchyTreeNodeValue processCategoryTreeNodeValue = new TaskHierarchyTreeNodeValue();
   processCategoryTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE;
   processCategoryTreeNodeValue.categoryCode = elementOfCaseProcessCategoriesITask.getProcessCategoryCode();
   processCategoryTreeNodeValue.categoryName = (elementOfCaseProcessCategoriesITask.getProcessName() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryName(): 
					(elementOfCaseProcessCategoriesITask.getProcessCategoryCode() is initialized? elementOfCaseProcessCategoriesITask.getProcessCategoryCode(): out.unclassifiedTasksTitle)) + " (" + caseProcessCategory.getNumberOfObjectsInGroup() + ")";

   caseProcessCategoryTree = currentParent.createChild(processCategoryTreeNodeValue, "PROCESS_CATEGORY_CODE");
   
   caseProcessesIGroup.clear();

   filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode());

	// consider the task states
	filter = filter.and(in.taskStatesPropertyFilter);
	
	// consider the filter set by user
	if(in.filterEnabled)
	{	
		filter = filter.and(in.taskAvailableFilters.propertyFilter);
	}

	// consider the priority sorting
	if(in.sortByPriority)
	{	
		filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
	}

	caseProcessesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, null, 
																																									in.runningTaskMode, in.taskDisplayMode));	

   // read process names of the given caseProcessCategory
   for (IGroup caseProcess: caseProcessesIGroup)
   {
      elementOfCaseProcessesITask = caseProcess.getFirstObjectInGroup() as ITask;

      TaskHierarchyTreeNodeValue caseProcessTreeNodeValue = new TaskHierarchyTreeNodeValue();
      caseProcessTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE;
      caseProcessTreeNodeValue.categoryCode = elementOfCaseProcessesITask.getProcessCode();
      caseProcessTreeNodeValue.categoryName = (elementOfCaseProcessesITask.getProcessName() is initialized? elementOfCaseProcessesITask.getProcessName(): caseProcessTreeNodeValue.categoryCode) + " (" + caseProcess.getNumberOfObjectsInGroup() + ")";
      caseProcessTree = caseProcessCategoryTree.createChild(caseProcessTreeNodeValue, "PROCESS_CODE");

      caseTypesIGroup.clear();


      filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                              ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessesITask.getProcessCode());

			// consider the task states
			filter = filter.and(in.taskStatesPropertyFilter);
			
			// consider the filter set by user
			if(in.filterEnabled)
			{
				filter = filter.and(in.taskAvailableFilters.propertyFilter);
			}

			// consider the priority sorting
			if (in.sortByPriority)
			{
				filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
			}

      caseTypesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.TYPE_CODE, null, 
																																									in.runningTaskMode, in.taskDisplayMode));
      
      // read type name of the process names of the given caseProcessCategory
      for (IGroup caseType: caseTypesIGroup)
      {
         elementOfCaseTypesITask = caseType.getFirstObjectInGroup() as ITask;

         TaskHierarchyTreeNodeValue caseTypeTreeNodeValue = new TaskHierarchyTreeNodeValue();
         caseTypeTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.TYPE_CODE;
         caseTypeTreeNodeValue.categoryCode = elementOfCaseTypesITask.getTypeCode();
         caseTypeTreeNodeValue.categoryName = (elementOfCaseTypesITask.getTypeName() is initialized? elementOfCaseTypesITask.getTypeName(): caseTypeTreeNodeValue.categoryCode) + " (" + caseType.getNumberOfObjectsInGroup() + ")";
         caseTypeTree = caseProcessTree.createChild(caseTypeTreeNodeValue,"TYPE_CODE");

         caseSubTypesIGroup.clear();


         filter = ivy.wf.createTaskPropertyFilter(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessCategoriesITask.getProcessCategoryCode()).and(
                                                                                       ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseProcessesITask.getProcessCode()).and(
                                                                                          ch.ivyteam.ivy.workflow.TaskProperty.TYPE_CODE, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, elementOfCaseTypesITask.getTypeCode());

					// consider the task states
					filter = filter.and(in.taskStatesPropertyFilter);
					
					// consider the filter set by user
					if(in.filterEnabled)
					{	
						filter = filter.and(in.taskAvailableFilters.propertyFilter);
					}

					// consider the priority sorting
					if(in.sortByPriority)
					{
						filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, currentPriorityNodeValue.categoryCode);
					}
				
         caseSubTypesIGroup.addAll(WorkflowUIAccessPermissionHandler.findTaskCategories(filter, ch.ivyteam.ivy.workflow.TaskProperty.SUB_TYPE_CODE, null, 
																																													in.runningTaskMode, in.taskDisplayMode));

         // read the subtype of the given type name of the given process names of the given caseProcessCategory         
         for (IGroup caseSubType: caseSubTypesIGroup)
         {
            elementOfCaseSubTypesITask = caseSubType.getFirstObjectInGroup() as ITask;

            TaskHierarchyTreeNodeValue caseSubTypeTreeNodeValue = new TaskHierarchyTreeNodeValue();
            caseSubTypeTreeNodeValue.property = ch.ivyteam.ivy.workflow.TaskProperty.SUB_TYPE_CODE;
            caseSubTypeTreeNodeValue.categoryCode = elementOfCaseSubTypesITask.getSubTypeCode();
            caseSubTypeTreeNodeValue.categoryName = (elementOfCaseSubTypesITask.getSubTypeName() is initialized? elementOfCaseSubTypesITask.getSubTypeName(): caseSubTypeTreeNodeValue.categoryCode) + " (" + caseSubType.getNumberOfObjectsInGroup() + ")";
            caseSubTypeTree = caseTypeTree.createChild(caseSubTypeTreeNodeValue,"SUB_TYPE_CODE");

            }// end for sub types
      }// end for types      
   }// end for processes
}// end for categories


}// end for parentsListOfTree' #txt
Ts0 f23 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f23 662 404 36 24 23 0 #rect
Ts0 f23 @|RichDialogProcessStepIcon #fIcon
Ts0 f179 expr in #txt
Ts0 f179 outCond 'in.taskHierarchyLayoutSelectedIndex == 0' #txt
Ts0 f179 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name></name>
    </language>
</elementInfo>
' #txt
Ts0 f179 1314 320 680 404 #arcP
Ts0 f179 1 680 320 #addKink
Ts0 f179 0 0.6647058823529411 0 0 #arcLabel
Ts0 f1 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>refresh</name>
        <nameStyle>7,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f1 guid 1190DFC3C057CAB3 #txt
Ts0 f1 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f1 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f1 actionTable 'out=in;
' #txt
Ts0 f1 1518 38 20 20 13 0 #rect
Ts0 f1 @|RichDialogProcessStartIcon #fIcon
Ts0 f2 expr out #txt
Ts0 f2 1528 58 1346 120 #arcP
Ts0 f2 1 1528 120 #addKink
Ts0 f2 0 0.8776120585055484 0 0 #arcLabel
Ts0 f22 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegateTask</name>
        <nameStyle>12,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f22 guid 1190E012A03F0F56 #txt
Ts0 f22 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f22 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f22 actionTable 'out=in;
' #txt
Ts0 f22 actionCode 'out.footerMessage = "";' #txt
Ts0 f22 2134 726 20 20 13 0 #rect
Ts0 f22 @|RichDialogProcessStartIcon #fIcon
Ts0 f25 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f25 2131 1187 26 26 14 0 #rect
Ts0 f25 @|RichDialogProcessEndIcon #fIcon
Ts0 f31 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f31 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f31 2130 778 28 28 14 0 #rect
Ts0 f31 @|AlternativeIcon #fIcon
Ts0 f32 expr out #txt
Ts0 f32 2144 746 2144 778 #arcP
Ts0 f35 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>inform
the user</name>
        <nameStyle>15,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f35 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f35 actionTable 'out=in;
' #txt
Ts0 f35 actionCode 'out.footerMessage = in.invalidSelection;' #txt
Ts0 f35 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f35 2510 988 36 24 20 -2 #rect
Ts0 f35 @|RichDialogProcessStepIcon #fIcon
Ts0 f40 expr out #txt
Ts0 f40 2528 1012 2157 1200 #arcP
Ts0 f40 1 2528 1200 #addKink
Ts0 f40 0 0.8077395336371307 0 0 #arcLabel
Ts0 f39 expr in #txt
Ts0 f39 2158 792 2528 988 #arcP
Ts0 f39 1 2528 792 #addKink
Ts0 f39 0 0.6573840291579892 0 0 #arcLabel
Ts0 f45 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>load the Rich Dialog
and choose the security member</name>
        <nameStyle>51,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f45 targetWindow NEW #txt
Ts0 f45 targetDisplay TOP #txt
Ts0 f45 richDialogId ch.ivyteam.ivy.workflow.ui.common.SecurityMemberSelect #txt
Ts0 f45 startMethod startAndChooseSecurityMember() #txt
Ts0 f45 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f45 requestActionDecl '<> param;' #txt
Ts0 f45 responseActionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f45 responseMappingAction 'out=in;
out.securityMember=result.aSecurityMember;
out.securityMemberSelected=result.aSecurityMemberSelected;
' #txt
Ts0 f45 windowConfiguration '#Fri Aug 01 20:34:51 CEST 2008
height=0
maximized=false
centered=true
close_after_last_rd=true
resizable=true
width=0
title=<%\\=in.taskDelegateWindowTitle%>
' #txt
Ts0 f45 isAsynch false #txt
Ts0 f45 isInnerRd true #txt
Ts0 f45 isDialog true #txt
Ts0 f45 2126 916 36 24 20 -2 #rect
Ts0 f45 @|RichDialogIcon #fIcon
Ts0 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f59 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f59 2130 962 28 28 14 0 #rect
Ts0 f59 @|AlternativeIcon #fIcon
Ts0 f64 expr out #txt
Ts0 f64 2144 940 2144 962 #arcP
Ts0 f72 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>delegate the task,
fire the bcevent &quot;xivyTaskDelegated&quot;,
if not wf admin remove the delegated task</name>
        <nameStyle>98,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f72 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f72 actionTable 'out=in;
' #txt
Ts0 f72 actionCode 'import ch.ivyteam.ivy.workflow.ITask;


Tree selectedTree = panel.tasksHierarchyLayoutTree.getSelectedTreeNode();
Tree parentOfSelectedTree = selectedTree.getParent();

ITask selectedTask = selectedTree.value as ITask;

try
{
	if (selectedTask.isExpired())
	{
		selectedTask.setExpiryActivator(in.securityMember);
	}
	else
	{
		selectedTask.setOriginalActivator(in.securityMember);
	}
	
	
	// fire the bcevent that task has been delegated
	panel.fireXivyTaskDelegated(selectedTask.getIdentifier());
	
	
	// remove the selected tree node from tree
	if (in.taskDisplayMode != 2)
	{
		selectedTree.removeFromParent();
	}
	
// out.footerMessage = "Task removed from Tasks Hierarchy.";
}
catch(Exception e)
{
	out.exception = e;	
}' #txt
Ts0 f72 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f72 2126 1020 36 24 20 -2 #rect
Ts0 f72 @|RichDialogProcessStepIcon #fIcon
Ts0 f73 expr in #txt
Ts0 f73 outCond in.securityMemberSelected #txt
Ts0 f73 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>security member selected</name>
        <nameStyle>24,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f73 2144 990 2144 1020 #arcP
Ts0 f75 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f75 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f75 346 1106 28 28 14 0 #rect
Ts0 f75 @|AlternativeIcon #fIcon
Ts0 f77 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>load
running task list</name>
        <nameStyle>22,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f77 targetWindow THIS #txt
Ts0 f77 targetDisplay <%=in.destinationDisplay.getDisplayId()%> #txt
Ts0 f77 richDialogId ch.ivyteam.ivy.workflow.ui.task.RunningTaskDisplayList #txt
Ts0 f77 startMethod start(Boolean,ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay,ch.ivyteam.ivy.workflow.IPropertyFilter,Number,Boolean) #txt
Ts0 f77 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f77 panelName <%=in.taskHierarchyContext.title%> #txt
Ts0 f77 requestActionDecl '<Boolean aRunningTaskMode, ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay aTaskDisplayListParentDisplay, ch.ivyteam.ivy.workflow.IPropertyFilter aPropertyFilter, Number aTaskDisplayMode, Boolean aHasWfAdministratorPermissions> param;' #txt
Ts0 f77 requestMappingAction 'param.aRunningTaskMode=in.runningTaskMode;
param.aTaskDisplayListParentDisplay=in.destinationDisplay;
param.aPropertyFilter=in.taskHierarchyContext.propertyFilter;
param.aTaskDisplayMode=in.taskDisplayMode;
param.aHasWfAdministratorPermissions=in.hasWfAdministratorPermissions;
' #txt
Ts0 f77 responseActionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f77 responseMappingAction 'out=in;
' #txt
Ts0 f77 windowConfiguration '#Fri Jul 18 18:14:48 CEST 2008
use_default=true
' #txt
Ts0 f77 isAsynch true #txt
Ts0 f77 isInnerRd true #txt
Ts0 f77 isDialog false #txt
Ts0 f77 342 1244 36 24 20 -2 #rect
Ts0 f77 @|RichDialogIcon #fIcon
Ts0 f81 guid 1190F07193BE2E61 #txt
Ts0 f81 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f81 method start(Boolean,ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay,Boolean,Boolean) #txt
Ts0 f81 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.Boolean aMultipleTaskListMode,ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay aDestinationDisplay,java.lang.Boolean aRunningTaskMode,java.lang.Boolean aHasWfAdministratorPermissions> param = methodEvent.getInputArguments();
' #txt
Ts0 f81 inParameterMapAction 'out.destinationDisplay=param.aDestinationDisplay;
out.hasWfAdministratorPermissions=param.aHasWfAdministratorPermissions;
out.runningTaskMode=param.aRunningTaskMode;
out.taskDisplayMode=1;
' #txt
Ts0 f81 inActionCode 'import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;
import ch.ivyteam.ivy.workflow.ui.utils.UserPropertyKeys;


out.taskStatesPropertyFilter = 
WorkflowUIAccessPermissionHandler.getTaskStatesPropertyFilterByRunningModeAndTaskDisplayMode(
			out.runningTaskMode,
			out.taskDisplayMode);
		
			
Boolean hasUserReadPropertyPermission = ivy.session.hasPermission(ivy.request.getApplication().getSecurityDescriptor(), ch.ivyteam.ivy.security.IPermission.USER_READ_PROPERTY);

out.taskHierarchyLayoutSelectedIndex = 
	(hasUserReadPropertyPermission && ivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_KEY).length() > 0)?
	ivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_KEY).toNumber():
	ivy.cms.co(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_CMS_DEFAULT_VALUE).toNumber();

out.sortByPriority = 
	(hasUserReadPropertyPermission && ivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_SORTED_BY_PRIORITY_PROPERTY_KEY).length() > 0)?
	ivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_SORTED_BY_PRIORITY_PROPERTY_KEY).equalsIgnoreCase("true"):
	ivy.cms.co(UserPropertyKeys.TASKS_SORTED_BY_PRIORITY_PROPERTY_CMS_DEFAULT_VALUE).equalsIgnoreCase("true");

out.multipleTaskListMode = 
	(hasUserReadPropertyPermission && ivy.session.getSessionUser().getProperty(UserPropertyKeys.IS_MULTIPLE_TASKLIST_MODE_PROPERTY_KEY).length() > 0)?
	ivy.session.getSessionUser().getProperty(UserPropertyKeys.IS_MULTIPLE_TASKLIST_MODE_PROPERTY_KEY).equalsIgnoreCase("true"):
	ivy.cms.co(UserPropertyKeys.IS_MULTIPLE_TASKLIST_MODE_PROPERTY_CMS_DEFAULT_VALUE).equalsIgnoreCase("true");
' #txt
Ts0 f81 outParameterDecl '<> result;
' #txt
Ts0 f81 embeddedRdInitializations '{/taskHierarchyLayoutSelectRDC {/fieldName "taskHierarchyLayoutSelectRDC"/startMethod "start()"/parameterMapping ""/initScript "\n/*\nimport ch.ivyteam.ivy.workflow.ui.utils.UserPropertyKeys;\nBoolean hasUserReadPropertyPermission = ivy.session.hasPermission(ivy.request.getApplication().getSecurityDescriptor(), ch.ivyteam.ivy.security.IPermission.USER_READ_PROPERTY);\n\nparam.aTaskHierarchyLayoutPrefferedIndex = \n\t(hasUserReadPropertyPermission && ivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_KEY).length() > 0)?\n\tivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_KEY).toNumber():\n\tivy.cms.co(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_CMS_DEFAULT_VALUE).toNumber();\n*/\t"}/taskFiltersSelectRDC {/fieldName "taskFiltersSelectRDC"/startMethod "start(Boolean,Number)"/parameterMapping "param.aRunningTaskMode=in.runningTaskMode;\nparam.aTaskDisplayMode=1;\n"/initScript ""}}' #txt
Ts0 f81 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start(Boolean, RTabbedDisplay, Boolean,Boolean)</name>
        <nameStyle>47,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f81 214 62 20 20 13 0 #rect
Ts0 f81 @|RichDialogInitStartIcon #fIcon
Ts0 f84 expr out #txt
Ts0 f84 360 1068 360 1106 #arcP
Ts0 f80 expr out #txt
Ts0 f80 360 1268 360 1299 #arcP
Ts0 f94 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>close existing
task list
instances</name>
        <nameStyle>34,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f94 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f94 actionTable 'out=in;
' #txt
Ts0 f94 actionCode 'import com.ulcjava.base.application.ULCComponent;
import ch.ivyteam.ivy.workflow.ui.task.RunningTaskDisplayList.RunningTaskDisplayListPanel;
import ch.ivyteam.ivy.workflow.ui.task.FinishedTaskDisplayList.FinishedTaskDisplayListPanel;
import ch.ivyteam.ivy.richdialog.exec.panel.IRichDialogPanel;

// check if some instance of task list is already available
if (in.destinationDisplay.getComponentCount() > 0)
{
	List<ULCComponent> componentsList = in.destinationDisplay.getComponents().toList();
	Boolean found = false;

	for (ULCComponent currentComponent: componentsList)
	{
		if ((in.runningTaskMode && currentComponent instanceof RunningTaskDisplayListPanel) || 
				(!in.runningTaskMode && currentComponent instanceof FinishedTaskDisplayListPanel))
		{
			(currentComponent as IRichDialogPanel).getPanelAPI().unload();
		}	
	}

}' #txt
Ts0 f94 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f94 534 1156 36 24 21 -30 #rect
Ts0 f94 @|RichDialogProcessStepIcon #fIcon
Ts0 f95 expr in #txt
Ts0 f95 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>unique task list 
required</name>
        <nameStyle>26,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f95 373 1121 552 1156 #arcP
Ts0 f95 1 552 1136 #addKink
Ts0 f95 0 0.7882600880183475 0 2 #arcLabel
Ts0 f21 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>startTask</name>
        <nameStyle>9,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f21 guid 11913F35F499D7A1 #txt
Ts0 f21 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f21 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f21 actionTable 'out=in;
' #txt
Ts0 f21 actionCode 'out.footerMessage = "";' #txt
Ts0 f21 1534 726 20 20 13 0 #rect
Ts0 f21 @|RichDialogProcessStartIcon #fIcon
Ts0 f44 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f44 1531 1163 26 26 14 0 #rect
Ts0 f44 @|RichDialogProcessEndIcon #fIcon
Ts0 f52 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f52 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f52 1530 762 28 28 14 0 #rect
Ts0 f52 @|AlternativeIcon #fIcon
Ts0 f53 expr out #txt
Ts0 f53 1544 746 1544 762 #arcP
Ts0 f60 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>inform 
the user</name>
        <nameStyle>16,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f60 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f60 actionTable 'out=in;
' #txt
Ts0 f60 actionCode 'out.footerMessage = in.invalidSelection;' #txt
Ts0 f60 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f60 1742 940 36 24 20 -2 #rect
Ts0 f60 @|RichDialogProcessStepIcon #fIcon
Ts0 f92 expr out #txt
Ts0 f92 1760 964 1557 1176 #arcP
Ts0 f92 1 1760 1176 #addKink
Ts0 f92 0 0.768741924943285 0 0 #arcLabel
Ts0 f48 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>check that 
this task has 
already be loaded 
if yes , refresh it, otherwise load it</name>
        <nameStyle>84,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f48 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f48 actionTable 'out=in;
' #txt
Ts0 f48 actionCode 'import ch.ivyteam.ivy.workflow.ui.task.TaskDisplay.TaskDisplayPanel;
import com.ulcjava.base.application.ULCComponent;
import ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay;


RTabbedDisplay selectedTabbedDisplay = in.destinationDisplay;
List<ULCComponent> componentsList;


// display under this tab
componentsList = in.destinationDisplay.getComponents().toList();

// reset the flag (task found on display to false)
out.taskAlreadyLoadedOnDisplay = false;


for (int i=0; i< componentsList.size(); i++)
{
	ULCComponent currentComponent = componentsList.get(i);
	
	if (currentComponent instanceof TaskDisplayPanel && (currentComponent as TaskDisplayPanel).getTaskIdentifier() == in.selectedTask.getIdentifier().intValue())
	{
		// task has been already loaded
		// it should be selected and refresh
		(currentComponent as TaskDisplayPanel).refresh();
		selectedTabbedDisplay.setSelectedComponent(currentComponent);
		out.taskAlreadyLoadedOnDisplay = true;
		
		// exit from the loop
		i = componentsList.size();
	}
	
}


' #txt
Ts0 f48 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f48 1526 932 36 24 20 -2 #rect
Ts0 f48 @|RichDialogProcessStepIcon #fIcon
Ts0 f102 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f102 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f102 1530 994 28 28 14 0 #rect
Ts0 f102 @|AlternativeIcon #fIcon
Ts0 f103 expr out #txt
Ts0 f103 1544 956 1544 994 #arcP
Ts0 f104 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f104 targetWindow THIS #txt
Ts0 f104 targetDisplay <%=in.destinationDisplay.getDisplayId()%> #txt
Ts0 f104 richDialogId ch.ivyteam.ivy.workflow.ui.task.TaskDisplay #txt
Ts0 f104 startMethod start(ch.ivyteam.ivy.workflow.ITask,Boolean,Boolean) #txt
Ts0 f104 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f104 panelName '<%=in.selectedTask.name%> - Task id <%=in.selectedTask.getIdentifier()%>' #txt
Ts0 f104 requestActionDecl '<ch.ivyteam.ivy.workflow.ITask aTask, Boolean aStartTaskRequested, Boolean aHasWfAdministratorPermissions> param;' #txt
Ts0 f104 requestMappingAction 'param.aTask=in.selectedTask;
param.aStartTaskRequested=true;
param.aHasWfAdministratorPermissions=in.hasWfAdministratorPermissions;
' #txt
Ts0 f104 responseActionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f104 responseMappingAction 'out=in;
' #txt
Ts0 f104 windowConfiguration '#Fri Jul 18 18:43:17 CEST 2008
use_default=true
' #txt
Ts0 f104 isAsynch true #txt
Ts0 f104 isInnerRd true #txt
Ts0 f104 isDialog false #txt
Ts0 f104 1526 1052 36 24 20 -2 #rect
Ts0 f104 @|RichDialogIcon #fIcon
Ts0 f105 expr in #txt
Ts0 f105 outCond !in.taskAlreadyLoadedOnDisplay #txt
Ts0 f105 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>task is not
already loaded to display</name>
        <nameStyle>37,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f105 1544 1022 1544 1052 #arcP
Ts0 f101 expr out #txt
Ts0 f101 1544 1076 1544 1163 #arcP
Ts0 f106 expr in #txt
Ts0 f106 1558 1008 1557 1176 #arcP
Ts0 f106 1 1624 1008 #addKink
Ts0 f106 2 1624 1176 #addKink
Ts0 f106 1 0.333982959118046 0 0 #arcLabel
Ts0 f107 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>keep the 
selected task node</name>
        <nameStyle>28,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f107 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f107 actionTable 'out=in;
' #txt
Ts0 f107 actionCode 'out.selectedTask = panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value as ch.ivyteam.ivy.workflow.ITask;' #txt
Ts0 f107 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f107 1526 836 36 24 20 -2 #rect
Ts0 f107 @|RichDialogProcessStepIcon #fIcon
Ts0 f108 expr in #txt
Ts0 f108 outCond 'panel.tasksHierarchyLayoutTree.getSelectedTreeNode() != null && 
panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value instanceof ch.ivyteam.ivy.workflow.ITask' #txt
Ts0 f108 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>tree selection != null and instanceof ITask
</name>
        <nameStyle>44,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f108 1544 790 1544 836 #arcP
Ts0 f109 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f109 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f109 1530 874 28 28 14 0 #rect
Ts0 f109 @|AlternativeIcon #fIcon
Ts0 f111 expr out #txt
Ts0 f111 1544 860 1544 874 #arcP
Ts0 f99 expr in #txt
Ts0 f99 outCond '(panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value as ch.ivyteam.ivy.workflow.ITask).getState().equals(ch.ivyteam.ivy.workflow.TaskState.SUSPENDED) || 
(panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value as ch.ivyteam.ivy.workflow.ITask).getState().equals(ch.ivyteam.ivy.workflow.TaskState.PARKED)' #txt
Ts0 f99 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>task state is SUSPENDED or PARKED</name>
        <nameStyle>33,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f99 1544 902 1544 932 #arcP
Ts0 f115 expr in #txt
Ts0 f115 1558 888 1760 940 #arcP
Ts0 f115 1 1760 888 #addKink
Ts0 f115 0 0.5811020698509343 0 0 #arcLabel
Ts0 f112 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>loadTaskInformation</name>
        <nameStyle>19,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f112 guid 119140995E3210DF #txt
Ts0 f112 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f112 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f112 actionTable 'out=in;
' #txt
Ts0 f112 actionCode 'out.footerMessage = "";' #txt
Ts0 f112 1878 726 20 20 13 0 #rect
Ts0 f112 @|RichDialogProcessStartIcon #fIcon
Ts0 f113 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f113 1875 1163 26 26 14 0 #rect
Ts0 f113 @|RichDialogProcessEndIcon #fIcon
Ts0 f116 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f116 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f116 1874 770 28 28 14 0 #rect
Ts0 f116 @|AlternativeIcon #fIcon
Ts0 f117 expr out #txt
Ts0 f117 1888 746 1888 770 #arcP
Ts0 f118 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>keep the 
selected task node</name>
        <nameStyle>28,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f118 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f118 actionTable 'out=in;
' #txt
Ts0 f118 actionCode 'out.selectedTask = panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value as ch.ivyteam.ivy.workflow.ITask;' #txt
Ts0 f118 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f118 1870 868 36 24 20 -2 #rect
Ts0 f118 @|RichDialogProcessStepIcon #fIcon
Ts0 f119 expr in #txt
Ts0 f119 outCond 'panel.tasksHierarchyLayoutTree.getSelectedTreeNode() != null && 
panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value instanceof ch.ivyteam.ivy.workflow.ITask' #txt
Ts0 f119 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>tree selection != null and instanceof ITask</name>
        <nameStyle>43,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f119 1888 798 1888 868 #arcP
Ts0 f123 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>inform 
the user</name>
        <nameStyle>16,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f123 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f123 actionTable 'out=in;
' #txt
Ts0 f123 actionCode 'out.footerMessage = in.invalidSelection;' #txt
Ts0 f123 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f123 2014 916 36 24 20 -2 #rect
Ts0 f123 @|RichDialogProcessStepIcon #fIcon
Ts0 f124 expr in #txt
Ts0 f124 1902 784 2032 916 #arcP
Ts0 f124 1 2032 784 #addKink
Ts0 f124 0 0.8999919058106153 0 0 #arcLabel
Ts0 f125 expr out #txt
Ts0 f125 2032 940 1901 1176 #arcP
Ts0 f125 1 2032 1176 #addKink
Ts0 f125 0 0.9594326066909116 0 0 #arcLabel
Ts0 f114 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>check that 
this task has 
already be loaded 
if yes , refresh it, otherwise load it</name>
        <nameStyle>84,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f114 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f114 actionTable 'out=in;
' #txt
Ts0 f114 actionCode 'import ch.ivyteam.ivy.workflow.ui.task.TaskDisplay.TaskDisplayPanel;
import com.ulcjava.base.application.ULCComponent;
import ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay;


RTabbedDisplay selectedTabbedDisplay = in.destinationDisplay;
List<ULCComponent> componentsList;


// display under this tab
selectedTabbedDisplay = in.destinationDisplay;
componentsList = in.destinationDisplay.getComponents().toList();

// reset the flag (task found on display to false)
out.taskAlreadyLoadedOnDisplay = false;


for (int i=0; i< componentsList.size(); i++)
{
	ULCComponent currentComponent = componentsList.get(i);
	
	if (currentComponent instanceof TaskDisplayPanel && (currentComponent as TaskDisplayPanel).getTaskIdentifier() == in.selectedTask.getIdentifier().intValue())
	{
		// task has been already loaded
		// it should be selected and refresh
		(currentComponent as TaskDisplayPanel).refresh();
		selectedTabbedDisplay.setSelectedComponent(currentComponent);
		out.taskAlreadyLoadedOnDisplay = true;
		
		// exit from the loop
		i = componentsList.size();
	}
	
}


' #txt
Ts0 f114 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f114 1870 940 36 24 21 -13 #rect
Ts0 f114 @|RichDialogProcessStepIcon #fIcon
Ts0 f120 expr out #txt
Ts0 f120 1888 892 1888 940 #arcP
Ts0 f126 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f126 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f126 1874 994 28 28 14 0 #rect
Ts0 f126 @|AlternativeIcon #fIcon
Ts0 f127 expr out #txt
Ts0 f127 1888 964 1888 994 #arcP
Ts0 f128 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f128 targetWindow THIS #txt
Ts0 f128 targetDisplay <%=in.destinationDisplay.getDisplayId()%> #txt
Ts0 f128 richDialogId ch.ivyteam.ivy.workflow.ui.task.TaskDisplay #txt
Ts0 f128 startMethod start(ch.ivyteam.ivy.workflow.ITask,Boolean,Boolean) #txt
Ts0 f128 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f128 panelName '<%=in.selectedTask.name%> - Task id <%=in.selectedTask.getIdentifier()%>' #txt
Ts0 f128 requestActionDecl '<ch.ivyteam.ivy.workflow.ITask aTask, Boolean aStartTaskRequested, Boolean aHasWfAdministratorPermissions> param;' #txt
Ts0 f128 requestMappingAction 'param.aTask=in.selectedTask;
param.aStartTaskRequested=false;
param.aHasWfAdministratorPermissions=in.hasWfAdministratorPermissions;
' #txt
Ts0 f128 responseActionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f128 responseMappingAction 'out=in;
' #txt
Ts0 f128 windowConfiguration '#Fri Jul 18 18:43:12 CEST 2008
use_default=true
' #txt
Ts0 f128 isAsynch true #txt
Ts0 f128 isInnerRd true #txt
Ts0 f128 isDialog false #txt
Ts0 f128 1870 1052 36 24 20 -2 #rect
Ts0 f128 @|RichDialogIcon #fIcon
Ts0 f129 expr in #txt
Ts0 f129 outCond !in.taskAlreadyLoadedOnDisplay #txt
Ts0 f129 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>task is not
already loaded to display</name>
        <nameStyle>37,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f129 1888 1022 1888 1052 #arcP
Ts0 f122 expr out #txt
Ts0 f122 1888 1076 1888 1163 #arcP
Ts0 f130 expr in #txt
Ts0 f130 1902 1008 1901 1176 #arcP
Ts0 f130 1 1984 1008 #addKink
Ts0 f130 2 1984 1176 #addKink
Ts0 f130 1 0.2461383694341651 0 0 #arcLabel
Ts0 f24 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>empty RD step</name>
        <nameStyle>13,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f24 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f24 actionTable 'out=in;
' #txt
Ts0 f24 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f24 1310 516 36 24 20 -2 #rect
Ts0 f24 @|RichDialogProcessStepIcon #fIcon
Ts0 f79 expr out #txt
Ts0 f79 1112 428 1310 526 #arcP
Ts0 f79 1 1112 504 #addKink
Ts0 f79 1 0.2959768313486882 0 0 #arcLabel
Ts0 f98 expr out #txt
Ts0 f98 1328 540 1328 587 #arcP
Ts0 f131 expr out #txt
Ts0 f131 912 428 1310 527 #arcP
Ts0 f131 1 912 512 #addKink
Ts0 f131 1 0.44181660623657804 0 0 #arcLabel
Ts0 f61 expr out #txt
Ts0 f61 680 428 1310 528 #arcP
Ts0 f61 1 680 528 #addKink
Ts0 f61 1 0.32864612654254743 0 0 #arcLabel
Ts0 f89 expr out #txt
Ts0 f89 1328 428 1328 516 #arcP
Ts0 f89 0 0.36175915259836816 0 0 #arcLabel
Ts0 f110 expr out #txt
Ts0 f110 1552 428 1346 525 #arcP
Ts0 f110 1 1552 496 #addKink
Ts0 f110 1 0.3506364700329271 0 0 #arcLabel
Ts0 f121 expr out #txt
Ts0 f121 1800 428 1346 527 #arcP
Ts0 f121 1 1800 504 #addKink
Ts0 f121 1 0.4027252706690888 0 0 #arcLabel
Ts0 f132 expr out #txt
Ts0 f132 2040 428 1346 528 #arcP
Ts0 f132 1 2040 528 #addKink
Ts0 f132 1 0.39978779704285744 0 0 #arcLabel
Ts0 f5 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f5 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f5 1042 930 28 28 14 0 #rect
Ts0 f5 @|AlternativeIcon #fIcon
Ts0 f145 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build the 
unclassified tasks</name>
        <nameStyle>29,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f145 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f145 actionTable 'out=in;
' #txt
Ts0 f145 actionCode 'import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;
import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.IPropertyFilter;
import ch.ivyteam.ivy.persistence.IQueryResult;
import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.PropertyOrder;



IQueryResult queryResult;
List<ITask> result= [];
List<PropertyOrder> order = [];
java.util.EnumSet states;
IPropertyFilter filter = in.taskStatesPropertyFilter;

int startIndex = 0;
int count = -1;
Boolean returnAllCount = true;
int allCount;


Tree taskTree;

Tree unclassifiedTasksTree;
TaskHierarchyTreeNodeValue unclassifiedTasksTreeNodeValue;


// get the node "unclassified tasks" under the root node
unclassifiedTasksTree = in.treeLoadEvent.getTreeNode();
unclassifiedTasksTreeNodeValue = unclassifiedTasksTree.value as TaskHierarchyTreeNodeValue;




// setup order
order.add(new PropertyOrder(ch.ivyteam.ivy.workflow.TaskProperty.NAME));
// order.add(new PropertyOrder(ch.ivyteam.ivy.workflow.TaskProperty.BUSINESS_MAIN_CONTACT_NAME, ch.ivyteam.ivy.persistence.OrderDirection.ASCENDING));


// states
states = null;



// setup filter
// workflowContext.createTaskPropertyFilter(TaskProperty.PROCESS_CODE, RelationalOperator.IS, null);
filter = filter.and(unclassifiedTasksTreeNodeValue.property, 
										ch.ivyteam.logicalexpression.RelationalOperator.IS, 
										null);

// consider the sort by priority for "unclassified tasks"
if (in.sortByPriority && unclassifiedTasksTree.getParent().value instanceof TaskHierarchyTreeNodeValue)
{
	//ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY
	filter = filter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, 
											ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, 
											(unclassifiedTasksTree.getParent().value as TaskHierarchyTreeNodeValue).categoryCode);
}



// include user defined filter
if (in.filterDefined && in.filterEnabled)
{
	filter = filter.and(in.taskAvailableFilters.propertyFilter);
}



// find 
queryResult = WorkflowUIAccessPermissionHandler.findTasks(filter, order, startIndex, count, returnAllCount, in.runningTaskMode, in.taskDisplayMode);


// results
count = queryResult.getResultCount(); // number of results returned
allCount = queryResult.getAllCount(); // number of all results found
result.addAll(queryResult.getResultList());


// read the tasks and add them to "unclassified tasks" tree node
for (int i=0; i<result.size(); i++)
{
	ITask elementOfTasksITask = result.get(i);
	taskTree = new Tree(elementOfTasksITask , "ID");
	taskTree.setMayHaveChildren(false);
	unclassifiedTasksTree.add(taskTree);			
  
}// end for task


' #txt
Ts0 f145 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f145 1190 1004 36 24 20 -2 #rect
Ts0 f145 @|RichDialogProcessStepIcon #fIcon
Ts0 f146 expr in #txt
Ts0 f146 outCond '(in.treeLoadEvent.getTreeNode().value as ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue).property.equals(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE) &&
(in.treeLoadEvent.getTreeNode().value as ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue).categoryCode.equals("")' #txt
Ts0 f146 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>process category code property
and its empty 
(used for unclassified tasks)</name>
        <nameStyle>75,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f146 1069 945 1208 1004 #arcP
Ts0 f146 1 1208 952 #addKink
Ts0 f146 0 0.6487966873393435 0 0 #arcLabel
Ts0 f147 expr out #txt
Ts0 f147 1208 1028 1068 1118 #arcP
Ts0 f147 1 1208 1104 #addKink
Ts0 f147 1 0.3299800381305926 0 0 #arcLabel
Ts0 f148 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f148 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f148 346 970 28 28 14 0 #rect
Ts0 f148 @|AlternativeIcon #fIcon
Ts0 f151 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build the filter for 
unclassified tasks</name>
        <nameStyle>40,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f151 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f151 actionTable 'out=in;
' #txt
Ts0 f151 actionCode 'import ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue;
import ch.ivyteam.ivy.workflow.IPropertyFilter;



Tree selectedTree;
IPropertyFilter propertyFilter;


// set the title and tooltip of the task list instance
selectedTree = panel.tasksHierarchyLayoutTree.getSelectedTreeNode();



// set the filter for unclassified tasks
propertyFilter = ivy.wf.createTaskPropertyFilter(
													ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE, 
													ch.ivyteam.logicalexpression.RelationalOperator.IS, 
													null);


// consider the sort by priority for "unclassified tasks"
if (in.sortByPriority && selectedTree.getParent().value instanceof TaskHierarchyTreeNodeValue)
{
	//ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY
	propertyFilter = propertyFilter.and(ch.ivyteam.ivy.workflow.TaskProperty.PRIORITY, 
																			ch.ivyteam.logicalexpression.RelationalOperator.EQUAL, 
																			(selectedTree.getParent().value as TaskHierarchyTreeNodeValue).categoryCode);
}


String displayedNodeValue = (selectedTree.value as TaskHierarchyTreeNodeValue).categoryName;

out.taskHierarchyContext.propertyFilter = out.taskHierarchyContext.propertyFilter.and(propertyFilter);
out.taskHierarchyContext.title += " - " + displayedNodeValue;
out.taskHierarchyContext.icon = "";
out.taskHierarchyContext.toolTipText = out.taskHierarchyContext.title;
' #txt
Ts0 f151 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f151 534 1044 36 24 20 -2 #rect
Ts0 f151 @|RichDialogProcessStepIcon #fIcon
Ts0 f152 expr in #txt
Ts0 f152 outCond '(panel.tasksHierarchyLayoutTree.selectedTreeNode.value as ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue).property.equals(ch.ivyteam.ivy.workflow.TaskProperty.PROCESS_CATEGORY_CODE) &&
(panel.tasksHierarchyLayoutTree.selectedTreeNode.value as ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue).categoryCode.equals("")' #txt
Ts0 f152 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>process category code is null
(used for unclassified tasks)</name>
        <nameStyle>59,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f152 374 984 552 1044 #arcP
Ts0 f152 1 552 984 #addKink
Ts0 f152 1 0.08158238820433426 0 0 #arcLabel
Ts0 f150 expr out #txt
Ts0 f150 552 1068 373 1119 #arcP
Ts0 f150 1 552 1112 #addKink
Ts0 f150 1 0.26522136531608226 0 0 #arcLabel
Ts0 f34 expr in #txt
Ts0 f34 360 998 360 1044 #arcP
Ts0 f136 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>updatePopupMenuForSelectedNode</name>
        <nameStyle>30,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f136 guid 119E2F5EE885BF4A #txt
Ts0 f136 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f136 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f136 actionTable 'out=in;
' #txt
Ts0 f136 1046 1174 20 20 13 0 #rect
Ts0 f136 @|RichDialogProcessStartIcon #fIcon
Ts0 f139 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f139 1043 1419 26 26 14 0 #rect
Ts0 f139 @|RichDialogProcessEndIcon #fIcon
Ts0 f141 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f141 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f141 1042 1258 28 28 14 0 #rect
Ts0 f141 @|AlternativeIcon #fIcon
Ts0 f155 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>show the 
popup menu on task</name>
        <nameStyle>28,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f155 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f155 actionTable 'out=in;
' #txt
Ts0 f155 actionCode 'import ch.ivyteam.ivy.workflow.ITask;
import ch.ivyteam.ivy.workflow.TaskState;

ITask selectedTask = panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value as ch.ivyteam.ivy.workflow.ITask;

// update the tree node object on tree
panel.tasksHierarchyLayoutTree.getSelectedTreeNode().treeValueChanged();

// load tasks
panel.loadTaskListMenuItem.enabled = false;
panel.loadTaskListButton.enabled = false;


// refresh
panel.refreshTaskListButton.enabled = true;
panel.refreshTaskListMenuItem.enabled = true;


// open info on task
panel.informOnTaskButton.enabled = true;
panel.informOnTaskMenuItem.enabled = true;



Boolean startAndDelegateTaskToEnable = selectedTask.getState().equals(TaskState.SUSPENDED) || selectedTask.getState().equals(TaskState.PARKED);

// start task
panel.startTaskButton.enabled = startAndDelegateTaskToEnable && (in.taskDisplayMode != 2);
panel.startTaskMenuItem.enabled = panel.startTaskButton.enabled;

// delegate task
panel.delegateTaskButton.enabled = (startAndDelegateTaskToEnable && (in.hasPermissionDelegateTasks || in.hasWfAdministratorPermissions));
panel.delegateTaskMenuItem.enabled = panel.delegateTaskButton.enabled;

' #txt
Ts0 f155 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f155 1038 1340 36 24 20 -2 #rect
Ts0 f155 @|RichDialogProcessStepIcon #fIcon
Ts0 f163 expr in #txt
Ts0 f163 outCond 'panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value instanceof ch.ivyteam.ivy.workflow.ITask' #txt
Ts0 f163 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>is a ITask</name>
        <nameStyle>10,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f163 1056 1286 1056 1340 #arcP
Ts0 f140 expr out #txt
Ts0 f140 1056 1364 1056 1419 #arcP
Ts0 f166 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>enable disable
actions</name>
        <nameStyle>22,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f166 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f166 actionTable 'out=in;
' #txt
Ts0 f166 actionCode '// load tasks
panel.loadTaskListMenuItem.enabled = true;
panel.loadTaskListButton.enabled = true;


// refresh
panel.refreshTaskListButton.enabled = true;
panel.refreshTaskListMenuItem.enabled = true;


// open info on task
panel.informOnTaskButton.enabled = false;
panel.informOnTaskMenuItem.enabled = false;


// start task
panel.startTaskButton.enabled = false;
panel.startTaskMenuItem.enabled = false;


// delegate task
panel.delegateTaskButton.enabled = false;
panel.delegateTaskMenuItem.enabled = false;' #txt
Ts0 f166 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f166 1214 1340 36 24 20 -2 #rect
Ts0 f166 @|RichDialogProcessStepIcon #fIcon
Ts0 f167 expr in #txt
Ts0 f167 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>node but 
not a task</name>
        <nameStyle>20,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f167 1070 1272 1232 1340 #arcP
Ts0 f167 1 1232 1272 #addKink
Ts0 f167 0 0.7333021685227175 0 0 #arcLabel
Ts0 f168 expr out #txt
Ts0 f168 1232 1364 1069 1432 #arcP
Ts0 f168 1 1232 1432 #addKink
Ts0 f168 1 0.13018536977597953 0 0 #arcLabel
Ts0 f169 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f169 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f169 1042 1210 28 28 14 0 #rect
Ts0 f169 @|AlternativeIcon #fIcon
Ts0 f170 expr out #txt
Ts0 f170 1056 1194 1056 1210 #arcP
Ts0 f142 expr in #txt
Ts0 f142 outCond 'panel.tasksHierarchyLayoutTree.getSelectedTreeNode() != null' #txt
Ts0 f142 1056 1238 1056 1258 #arcP
Ts0 f87 expr in #txt
Ts0 f87 1558 776 1760 940 #arcP
Ts0 f87 1 1760 776 #addKink
Ts0 f87 0 0.9789552249755253 0 0 #arcLabel
Ts0 f172 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>check the permission
delegate the tasks</name>
        <nameStyle>39,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f172 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f172 2130 850 28 28 14 0 #rect
Ts0 f172 @|AlternativeIcon #fIcon
Ts0 f56 expr in #txt
Ts0 f56 outCond in.hasPermissionDelegateTasks #txt
Ts0 f56 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>permission ok</name>
        <nameStyle>13,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f56 2144 878 2144 916 #arcP
Ts0 f173 expr in #txt
Ts0 f173 outCond 'panel.tasksHierarchyLayoutTree.getSelectedTreeNode() != null && 
panel.tasksHierarchyLayoutTree.getSelectedTreeNode().value instanceof ch.ivyteam.ivy.workflow.ITask' #txt
Ts0 f173 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>selected tree != null,
selected tree.node is a ITask type</name>
        <nameStyle>57,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f173 2144 806 2144 850 #arcP
Ts0 f173 0 0.26666666666666666 17 0 #arcLabel
Ts0 f7 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>filterDefinitionConfirmed</name>
        <nameStyle>25,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f7 guid 11A129AA4D827C4C #txt
Ts0 f7 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f7 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f7 actionTable 'out=in;
' #txt
Ts0 f7 actionCode 'import ch.ivyteam.ivy.workflow.ui.data.task.TaskAvailableFilters;
import ch.ivyteam.ivy.richdialog.exec.RdPanelEvent;


Object attachment = (event as RdPanelEvent).getAttachment();

if (attachment instanceof TaskAvailableFilters)
{
	out.filterDefined = true;
	out.taskAvailableFilters = attachment as TaskAvailableFilters;
}' #txt
Ts0 f7 2222 30 20 20 13 0 #rect
Ts0 f7 @|RichDialogProcessStartIcon #fIcon
Ts0 f10 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f10 2059 243 26 26 14 0 #rect
Ts0 f10 @|RichDialogProcessEndIcon #fIcon
Ts0 f13 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>filterDefinitionCanceled</name>
        <nameStyle>24,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f13 guid 11A129B373A71E8A #txt
Ts0 f13 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f13 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f13 actionTable 'out=in;
' #txt
Ts0 f13 2062 30 20 20 13 0 #rect
Ts0 f13 @|RichDialogProcessStartIcon #fIcon
Ts0 f100 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>colapse
the filter area</name>
        <nameStyle>23,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f100 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f100 actionTable 'out=in;
' #txt
Ts0 f100 actionCode 'panel.caseBusinessAndFiltersCollapsiblePane.collapsed = true;
' #txt
Ts0 f100 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f100 2054 164 36 24 20 -2 #rect
Ts0 f100 @|RichDialogProcessStepIcon #fIcon
Ts0 f12 expr out #txt
Ts0 f12 2072 188 2072 243 #arcP
Ts0 f37 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>enableFilter</name>
        <nameStyle>12,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f37 guid 11A12AB513F1FB3E #txt
Ts0 f37 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f37 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f37 actionTable 'out=in;
' #txt
Ts0 f37 1582 38 20 20 13 0 #rect
Ts0 f37 @|RichDialogProcessStartIcon #fIcon
Ts0 f137 expr out #txt
Ts0 f137 1592 58 1346 120 #arcP
Ts0 f137 1 1592 120 #addKink
Ts0 f137 1 0.34631744463866376 0 0 #arcLabel
Ts0 f138 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>init the data
build the displayid for carddisplay filter,
check the permissions,
get the confirmation title from CMS,
register the system events Workflow </name>
        <nameStyle>154,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f138 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f138 actionTable 'out=in;
' #txt
Ts0 f138 actionCode 'import ch.ivyteam.ivy.event.SystemEventCategory;
import ch.ivyteam.ivy.workflow.ui.data.common.HierarchyLayout;
import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;
import ch.ivyteam.ivy.workflow.IPropertyFilter;

import ch.ivyteam.ivy.workflow.ui.utils.UniqueDisplayIdFactory;
import ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay;



out.unclassifiedTasksTitle = 
		ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/uncategorizedTasks").toString();



// check the permissions
out.hasPermissionDelegateTasks = ivy.session.hasPermission(ivy.request.getApplication().getSecurityDescriptor(), 
																														ch.ivyteam.ivy.security.IPermission.DELEGATE_TASKS);
																														
out.hasPermisionRoleTreeNavigation = ivy.session.hasPermission(ivy.request.getApplication().getSecurityDescriptor(), 
																																ch.ivyteam.ivy.security.IPermission.ROLE_TREE_NAVIGATION);


out.confirmation = ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/confirmation");
out.invalidSelection = ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/invalidSelection");
																																
out.taskDelegateWindowTitle = ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/delegateTaskShortDesc");



// register to System events of Workflow category
ivy.rd.subscribeToSystemEvents(SystemEventCategory.WORKFLOW);' #txt
Ts0 f138 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f138 126 292 36 24 10 7 #rect
Ts0 f138 @|RichDialogProcessStepIcon #fIcon
Ts0 f180 expr out #txt
Ts0 f180 144 82 144 292 #arcP
Ts0 f9 expr out #txt
Ts0 f9 224 82 162 304 #arcP
Ts0 f9 1 224 304 #addKink
Ts0 f9 0 0.6706119958000182 0 0 #arcLabel
Ts0 f8 expr out #txt
Ts0 f8 144 316 144 531 #arcP
Ts0 f74 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>filter defined to false
filter enabled to false</name>
        <nameStyle>47,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f74 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f74 actionTable 'out=in;
' #txt
Ts0 f74 actionCode 'out.filterDefined = false;
out.filterEnabled = false;
' #txt
Ts0 f74 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f74 2054 116 36 24 23 -12 #rect
Ts0 f74 @|RichDialogProcessStepIcon #fIcon
Ts0 f83 expr out #txt
Ts0 f83 2072 50 2072 116 #arcP
Ts0 f83 0 0.4069479523614335 0 0 #arcLabel
Ts0 f134 expr out #txt
Ts0 f134 2072 140 2072 164 #arcP
Ts0 f134 0 0.1732791219460131 0 0 #arcLabel
Ts0 f184 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>expand the filter area,
set the current task 
display mode to filtersSelect RDC,
if filter enabled, disable it</name>
        <nameStyle>110,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f184 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f184 actionTable 'out=in;
' #txt
Ts0 f184 actionCode 'if (panel.caseBusinessAndFiltersCollapsiblePane.collapsed)
{
	panel.caseBusinessAndFiltersCollapsiblePane.collapsed = false;
	panel.taskFiltersSelectRDC.setTaskDisplayMode(in.taskDisplayMode);
}
else
{
	panel.caseBusinessAndFiltersCollapsiblePane.collapsed = true;
}' #txt
Ts0 f184 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f184 1894 172 36 24 20 -2 #rect
Ts0 f184 @|RichDialogProcessStepIcon #fIcon
Ts0 f6 expr out #txt
Ts0 f6 1912 196 1912 243 #arcP
Ts0 f41 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>onLoad</name>
        <nameStyle>6,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f41 guid 11AE3ADCCD99E297 #txt
Ts0 f41 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f41 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f41 actionTable 'out=in;
' #txt
Ts0 f41 470 62 20 20 13 0 #rect
Ts0 f41 @|RichDialogProcessStartIcon #fIcon
Ts0 f54 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>build popup menu 
text and icons,
titled borders
from CMS entries,
hide/show task display modes (radio buttons)</name>
        <nameStyle>111,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f54 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f54 actionTable 'out=in;
' #txt
Ts0 f54 actionCode 'import com.ulcjava.base.application.border.ULCTitledBorder;


panel.loadTaskListMenuItem.setText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/loadTaskListShortDesc"));
panel.loadTaskListMenuItem.setToolTipText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/loadTaskListLongDesc"));
panel.loadTaskListMenuItem.setIconUri("/ch/ivyteam/ivy/workflow/ui/task/images/loadTaskList16");


panel.refreshTaskListMenuItem.setText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/refreshTaskListShortDesc"));
panel.refreshTaskListMenuItem.setToolTipText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/refreshTaskListLongDesc"));
panel.refreshTaskListMenuItem.setIconUri("/ch/ivyteam/ivy/workflow/ui/task/images/refreshTaskList16");


panel.informOnTaskMenuItem.setText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/informOnTaskShortDesc"));
panel.informOnTaskMenuItem.setToolTipText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/informOnTaskLongDesc"));
panel.informOnTaskMenuItem.setIconUri("/ch/ivyteam/ivy/workflow/ui/task/images/informOnTask16");



panel.startTaskMenuItem.setText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/startTaskShortDesc"));
panel.startTaskMenuItem.setToolTipText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/startTaskLongDesc"));
panel.startTaskMenuItem.setIconUri("/ch/ivyteam/ivy/workflow/ui/task/images/startTask16");


panel.delegateTaskMenuItem.setText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/delegateTaskShortDesc"));
panel.delegateTaskMenuItem.setToolTipText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/delegateTaskLongDesc"));
panel.delegateTaskMenuItem.setIconUri("/ch/ivyteam/ivy/workflow/ui/task/images/delegateTask16");


panel.expandAllTasksMenuItem.setText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/expandAllTasksShortDesc"));
panel.expandAllTasksMenuItem.setToolTipText(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/expandAllTasksLongDesc"));
panel.expandAllTasksMenuItem.setIconUri(ivy.cms.cr("/ch/ivyteam/ivy/workflow/ui/task/images/expandAllTasks16"));



(panel.getBorder() as ULCTitledBorder).title = 
													(in.runningTaskMode? 
															ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/runningTasksShortDesc"): 
															ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/finishedTasksShortDesc"));					

(panel.viewGridBagLayoutPane.getBorder() as ULCTitledBorder).title = 								
		ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/taskDisplayOptions");

(panel.taskDisplayFlowLayoutPane.getBorder() as ULCTitledBorder).title = 								
		ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/taskDisplayMode");

(panel.filterBoxPane.getBorder() as ULCTitledBorder).title = 
		ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/filterTaskList");




panel.findAllEnvironmentTasksRadioButton.visible = in.hasWfAdministratorPermissions;

if (in.runningTaskMode)
{
	panel.findYourTasksRadioButton.visible = false;
	
	in.taskDisplayMode = 1;
	panel.findTeamTasksRadioButton.selected = true;
	panel.findTeamTasksRadioButton.visible = true;
}
else
{
	panel.findYourTasksRadioButton.visible = true;

	in.taskDisplayMode = 0;
	panel.findYourTasksRadioButton.selected = true;
	
	panel.findTeamTasksRadioButton.visible = false;
}

' #txt
Ts0 f54 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f54 462 212 36 24 20 -2 #rect
Ts0 f54 @|RichDialogProcessStepIcon #fIcon
Ts0 f135 expr out #txt
Ts0 f135 480 82 480 212 #arcP
Ts0 f135 0 0.5030175437789626 0 0 #arcLabel
Ts0 f50 expr out #txt
Ts0 f50 480 236 157 544 #arcP
Ts0 f50 1 480 544 #addKink
Ts0 f50 1 0.06538650631982346 0 0 #arcLabel
Ts0 f189 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findYourTasks</name>
        <nameStyle>13,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f189 guid 11B0DB6D312529DD #txt
Ts0 f189 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f189 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f189 actionTable 'out=in;
' #txt
Ts0 f189 actionCode 'out.taskDisplayMode = 0;' #txt
Ts0 f189 1670 38 20 20 13 0 #rect
Ts0 f189 @|RichDialogProcessStartIcon #fIcon
Ts0 f192 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findAllEnvironmentTasks</name>
        <nameStyle>23,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f192 guid 11B0DB6E6F8F8A9A #txt
Ts0 f192 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f192 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f192 actionTable 'out=in;
' #txt
Ts0 f192 actionCode 'out.taskDisplayMode = 2;' #txt
Ts0 f192 1742 86 20 20 13 0 #rect
Ts0 f192 @|RichDialogProcessStartIcon #fIcon
Ts0 f191 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>findTeamTasks</name>
        <nameStyle>13,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f191 guid 11B0DB6FB0C461B2 #txt
Ts0 f191 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f191 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f191 actionTable 'out=in;
' #txt
Ts0 f191 actionCode 'out.taskDisplayMode = 1;' #txt
Ts0 f191 1710 62 20 20 13 0 #rect
Ts0 f191 @|RichDialogProcessStartIcon #fIcon
Ts0 f196 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f196 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f196 346 1194 28 28 14 0 #rect
Ts0 f196 @|AlternativeIcon #fIcon
Ts0 f78 expr in #txt
Ts0 f78 outCond in.runningTaskMode #txt
Ts0 f78 360 1222 360 1244 #arcP
Ts0 f76 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>load
finished task list</name>
        <nameStyle>23,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f76 targetWindow THIS #txt
Ts0 f76 targetDisplay <%=in.destinationDisplay.getDisplayId()%> #txt
Ts0 f76 richDialogId ch.ivyteam.ivy.workflow.ui.task.FinishedTaskDisplayList #txt
Ts0 f76 startMethod start(Boolean,ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay,ch.ivyteam.ivy.workflow.IPropertyFilter,Number,Boolean) #txt
Ts0 f76 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f76 panelName <%=in.taskHierarchyContext.title%> #txt
Ts0 f76 requestActionDecl '<Boolean aRunningTaskMode, ch.ivyteam.ivy.richdialog.widgets.displays.RTabbedDisplay aTaskDisplayListParentDisplay, ch.ivyteam.ivy.workflow.IPropertyFilter aPropertyFilter, Number aTaskDisplayMode, Boolean aHasWfAdministratorPermissions> param;' #txt
Ts0 f76 requestMappingAction 'param.aRunningTaskMode=in.runningTaskMode;
param.aTaskDisplayListParentDisplay=in.destinationDisplay;
param.aPropertyFilter=in.taskHierarchyContext.propertyFilter;
param.aTaskDisplayMode=in.taskDisplayMode;
param.aHasWfAdministratorPermissions=in.hasWfAdministratorPermissions;
' #txt
Ts0 f76 responseActionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f76 responseMappingAction 'out=in;
' #txt
Ts0 f76 windowConfiguration '#Fri Jul 18 18:15:14 CEST 2008
use_default=true
' #txt
Ts0 f76 isAsynch true #txt
Ts0 f76 isInnerRd true #txt
Ts0 f76 isDialog false #txt
Ts0 f76 534 1244 36 24 20 -2 #rect
Ts0 f76 @|RichDialogIcon #fIcon
Ts0 f199 expr in #txt
Ts0 f199 374 1208 552 1244 #arcP
Ts0 f199 1 552 1208 #addKink
Ts0 f199 0 0.6136878585358624 0 0 #arcLabel
Ts0 f200 expr out #txt
Ts0 f200 552 1268 372 1310 #arcP
Ts0 f200 1 552 1288 #addKink
Ts0 f200 1 0.3845015447358696 0 0 #arcLabel
Ts0 f51 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>provide the task states filter,
build the title
&quot;all tasks&quot;</name>
        <nameStyle>59,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f51 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f51 actionTable 'out=in;
' #txt
Ts0 f51 actionCode 'String displayedNodeValue = ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/allTasks");

out.taskHierarchyContext.title += " - " + displayedNodeValue;
out.taskHierarchyContext.icon = "";
out.taskHierarchyContext.toolTipText = out.taskHierarchyContext.title;' #txt
Ts0 f51 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f51 718 1108 36 24 20 -2 #rect
Ts0 f51 @|RichDialogProcessStepIcon #fIcon
Ts0 f85 expr in #txt
Ts0 f85 outCond in.questionDialogPressedButtonResult.equals("yes") #txt
Ts0 f85 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>continue with loading 
of all tasks!</name>
        <nameStyle>36,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f85 736 1062 736 1108 #arcP
Ts0 f85 0 0.4894883718303329 0 0 #arcLabel
Ts0 f88 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f88 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f88 346 786 28 28 14 0 #rect
Ts0 f88 @|AlternativeIcon #fIcon
Ts0 f90 expr out #txt
Ts0 f90 360 746 360 786 #arcP
Ts0 f96 expr in #txt
Ts0 f96 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>selection == null
or
selection ==  ITask</name>
        <nameStyle>40,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f96 374 800 373 1312 #arcP
Ts0 f96 1 920 800 #addKink
Ts0 f96 2 920 1312 #addKink
Ts0 f96 0 0.13736263736263737 0 8 #arcLabel
Ts0 f97 expr in #txt
Ts0 f97 outCond 'panel.tasksHierarchyLayoutTree.selectedTreeNode.getPath().size() > 1' #txt
Ts0 f97 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>selected tree node 
is not root</name>
        <nameStyle>31,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f97 360 918 360 970 #arcP
Ts0 f97 0 0.2826086956521739 -6 1 #arcLabel
Ts0 f29 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f29 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f29 1042 842 28 28 14 0 #rect
Ts0 f29 @|AlternativeIcon #fIcon
Ts0 f149 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ts0 f149 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f149 1194 882 28 28 14 0 #rect
Ts0 f149 @|AlternativeIcon #fIcon
Ts0 f193 expr in #txt
Ts0 f193 outCond '!in.runningTaskMode && in.taskDisplayMode==1' #txt
Ts0 f193 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>it''s search for 
team finished tasks</name>
        <nameStyle>36,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f193 1070 856 1208 882 #arcP
Ts0 f193 1 1208 856 #addKink
Ts0 f193 0 0.5618729096989967 1 2 #arcLabel
Ts0 f204 expr in #txt
Ts0 f204 1056 958 1056 1012 #arcP
Ts0 f91 expr in #txt
Ts0 f91 outCond '(in.#treeLoadEvent!= null) && (in.treeLoadEvent.getTreeNode().value instanceof ch.ivyteam.ivy.workflow.ui.data.task.TaskHierarchyTreeNodeValue)' #txt
Ts0 f91 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>explanded node != null
and it is not a root node</name>
        <nameStyle>48,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f91 1056 798 1056 842 #arcP
Ts0 f143 expr in #txt
Ts0 f143 1056 870 1056 930 #arcP
Ts0 f144 expr in #txt
Ts0 f144 outCond in.hasPermisionRoleTreeNavigation #txt
Ts0 f144 1208 910 1069 943 #arcP
Ts0 f144 1 1208 928 #addKink
Ts0 f144 0 0.36430332212594185 0 0 #arcLabel
Ts0 f201 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>update the 
task states property filter</name>
        <nameStyle>39,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f201 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f201 actionTable 'out=in;
' #txt
Ts0 f201 actionCode 'import ch.ivyteam.ivy.workflow.ui.utils.WorkflowUIAccessPermissionHandler;

out.taskStatesPropertyFilter = 
WorkflowUIAccessPermissionHandler.getTaskStatesPropertyFilterByRunningModeAndTaskDisplayMode(out.runningTaskMode, out.taskDisplayMode);' #txt
Ts0 f201 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f201 1622 108 36 24 20 -2 #rect
Ts0 f201 @|RichDialogProcessStepIcon #fIcon
Ts0 f205 expr out #txt
Ts0 f205 1680 58 1658 120 #arcP
Ts0 f205 1 1680 120 #addKink
Ts0 f205 1 0.3998627797360128 0 0 #arcLabel
Ts0 f194 expr out #txt
Ts0 f194 1720 82 1658 120 #arcP
Ts0 f194 1 1720 120 #addKink
Ts0 f194 1 0.43963385877402117 0 0 #arcLabel
Ts0 f165 expr out #txt
Ts0 f165 1752 106 1658 120 #arcP
Ts0 f165 1 1752 120 #addKink
Ts0 f165 1 0.46976752361394136 0 0 #arcLabel
Ts0 f164 expr out #txt
Ts0 f164 1622 120 1346 120 #arcP
Ts0 f206 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>infom the user
permission denied</name>
        <nameStyle>32,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f206 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f206 actionTable 'out=in;
' #txt
Ts0 f206 actionCode '// ch.ivyteam.ivy.security.IPermission.ROLE_TREE_NAVIGATION' #txt
Ts0 f206 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f206 1334 972 36 24 20 -2 #rect
Ts0 f206 @|RichDialogProcessStepIcon #fIcon
Ts0 f207 expr in #txt
Ts0 f207 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>permission ko</name>
        <nameStyle>13,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f207 1222 896 1352 972 #arcP
Ts0 f207 1 1352 896 #addKink
Ts0 f207 0 0.9515157055268777 0 0 #arcLabel
Ts0 f208 expr out #txt
Ts0 f208 1352 996 1068 1119 #arcP
Ts0 f208 1 1352 1104 #addKink
Ts0 f208 1 0.30110974962602843 0 0 #arcLabel
Ts0 f175 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>disable all
actions</name>
        <nameStyle>19,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f175 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f175 actionTable 'out=in;
' #txt
Ts0 f175 actionCode '// load tasks
panel.loadTaskListMenuItem.enabled = false;
panel.loadTaskListButton.enabled = false;


// refresh
panel.refreshTaskListButton.enabled = false;
panel.refreshTaskListMenuItem.enabled = false;


// open info on task
panel.informOnTaskButton.enabled = false;
panel.informOnTaskMenuItem.enabled = false;


// start task
panel.startTaskButton.enabled = false;
panel.startTaskMenuItem.enabled = false;


// delegate task
panel.delegateTaskButton.enabled = false;
panel.delegateTaskMenuItem.enabled = false;' #txt
Ts0 f175 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f175 1350 1340 36 24 20 -2 #rect
Ts0 f175 @|RichDialogProcessStepIcon #fIcon
Ts0 f211 expr in #txt
Ts0 f211 1070 1224 1368 1340 #arcP
Ts0 f211 1 1368 1224 #addKink
Ts0 f211 1 0.07285348028575846 0 0 #arcLabel
Ts0 f171 expr out #txt
Ts0 f171 1368 1364 1069 1432 #arcP
Ts0 f171 1 1368 1432 #addKink
Ts0 f171 1 0.3298987596340076 0 0 #arcLabel
Ts0 f214 expr out #txt
Ts0 f214 1912 50 1912 172 #arcP
Ts0 f181 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>consider the task states,
add user filter if defined,
build the &quot;Running|Finished Tasks&quot; title</name>
        <nameStyle>94,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f181 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f181 actionTable 'out=in;
' #txt
Ts0 f181 actionCode 'out.taskHierarchyContext.propertyFilter = in.taskStatesPropertyFilter;

if (in.filterDefined && in.filterEnabled)
{
	out.taskHierarchyContext.propertyFilter = 
		out.taskHierarchyContext.propertyFilter.and(
			in.taskAvailableFilters.propertyFilter);
}

out.taskHierarchyContext.title = (in.runningTaskMode?
																	ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/runningTasksShortDesc"):
																	ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/finishedTasksShortDesc"));' #txt
Ts0 f181 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f181 342 836 36 24 20 -2 #rect
Ts0 f181 @|RichDialogProcessStepIcon #fIcon
Ts0 f182 expr in #txt
Ts0 f182 outCond 'panel.tasksHierarchyLayoutTree.getSelectedTreeNode() != null && 
!(panel.tasksHierarchyLayoutTree.selectedTreeNode.value instanceof ch.ivyteam.ivy.workflow.ITask)' #txt
Ts0 f182 360 814 360 836 #arcP
Ts0 f93 expr out #txt
Ts0 f93 360 860 360 890 #arcP
Ts0 f183 expr out #txt
Ts0 f183 718 1120 374 1120 #arcP
Ts0 f183 0 0.4180419206938257 0 0 #arcLabel
Ts0 f185 expr out #txt
Ts0 f185 552 1180 373 1207 #arcP
Ts0 f185 1 552 1192 #addKink
Ts0 f185 1 0.2579075331812409 0 0 #arcLabel
Ts0 f197 expr in #txt
Ts0 f197 outCond in.multipleTaskListMode #txt
Ts0 f197 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>multiple tasklist 
instances required</name>
        <nameStyle>37,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f197 360 1134 360 1194 #arcP
Ts0 f86 expr in #txt
Ts0 f86 2158 976 2157 1200 #arcP
Ts0 f86 1 2328 976 #addKink
Ts0 f86 2 2328 1200 #addKink
Ts0 f86 1 0.2874856085758458 0 0 #arcLabel
Ts0 f65 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>expandAllTreeNodes</name>
        <nameStyle>18,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f65 guid 11DABEDD95854A4D #txt
Ts0 f65 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f65 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f65 actionTable 'out=in;
' #txt
Ts0 f65 actionCode panel.tasksHierarchyLayoutTree.expandAll(); #txt
Ts0 f65 2366 30 20 20 13 0 #rect
Ts0 f65 @|RichDialogProcessStartIcon #fIcon
Ts0 f66 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f66 2363 275 26 26 14 0 #rect
Ts0 f66 @|RichDialogProcessEndIcon #fIcon
Ts0 f198 expr in #txt
Ts0 f198 2158 864 2157 1200 #arcP
Ts0 f198 1 2424 864 #addKink
Ts0 f198 2 2424 1200 #addKink
Ts0 f198 1 0.08069454644900985 0 0 #arcLabel
Ts0 f202 expr out #txt
Ts0 f202 2376 50 2376 275 #arcP
Ts0 f67 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>ivy_systemevent_workflow_task_changed</name>
        <nameStyle>37,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f67 guid 11E458210559B162 #txt
Ts0 f67 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f67 broadcast ivy_systemevent_workflow_task_changed #txt
Ts0 f67 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f67 actionTable 'out=in;
' #txt
Ts0 f67 actionCode 'import ch.ivyteam.ivy.workflow.WorkflowSystemEventParameter;
import ch.ivyteam.ivy.workflow.ITask;
import java.util.Iterator;


Number broadcastedTaskStateChangedTaskId = param.workflowSystemEventParameter.getIdentifiers().get(0) as Number;
	

if (panel.tasksHierarchyLayoutTree.getSelectedTreeNode() != null && 
	panel.tasksHierarchyLayoutTree.getSelectedTreeNode().getValue() instanceof ITask)
{
	// the currently selected ITask tree node should be updated
	ITask selectedTask = panel.tasksHierarchyLayoutTree.getSelectedTreeNode().getValue() as ITask;


	if (selectedTask.getIdentifier().compareTo(broadcastedTaskStateChangedTaskId) == 0)
	{
		panel.tasksHierarchyLayoutTree.getSelectedTreeNode().treeValueChanged();		
	}
}
else
{
	// some other ITask tree node should be updated
	Iterator iterator = in.tasksHierarchyLayoutTree.iterator();
	
	Tree currentTree;
	Boolean found = false;
	while (iterator.hasNext() && !found)
	{
		currentTree = iterator.next() as Tree;
		if (currentTree.getValue() instanceof ITask)
		{
			if ((currentTree.getValue() as ITask).getIdentifier().compareTo(broadcastedTaskStateChangedTaskId) == 0)
			{
				currentTree.treeValueChanged();
				found = true;
			}
		}
	}
}



' #txt
Ts0 f67 2510 70 20 20 13 0 #rect
Ts0 f67 @|RichDialogBroadcastStartIcon #fIcon
Ts0 f174 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f174 2507 275 26 26 14 0 #rect
Ts0 f174 @|RichDialogProcessEndIcon #fIcon
Ts0 f176 expr out #txt
Ts0 f176 2520 90 2520 275 #arcP
Ts0 f209 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>if the currently selected task match with broadcasted task identifier
then task node will be updated</name>
        <nameStyle>100,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f209 2556 12 24 24 10 0 #rect
Ts0 f209 @|IBIcon #fIcon
Ts0 f210 2556 24 2525 71 #arcP
Ts0 f212 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>too much tasks (&gt;300) ?</name>
        <nameStyle>23,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f212 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f212 722 890 28 28 -50 -31 #rect
Ts0 f212 @|AlternativeIcon #fIcon
Ts0 f213 expr in #txt
Ts0 f213 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>selected tree node
is root</name>
        <nameStyle>26,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f213 374 904 722 904 #arcP
Ts0 f213 0 0.3036649214659686 0 0 #arcLabel
Ts0 f187 expr in #txt
Ts0 f187 outCond '!in.hasWfAdministratorPermissions &&
(in.runningTaskMode? 
ivy.session.findWorkTasks(null, null, 0, -1, true, java.util.EnumSet.of(ch.ivyteam.ivy.workflow.TaskState.SUSPENDED, 
																						ch.ivyteam.ivy.workflow.TaskState.RESUMED, 
																						ch.ivyteam.ivy.workflow.TaskState.PARKED)).getAllCount() > 300:
ivy.session.findWorkedOnTasks(0, -1, null).size() > 300)																	' #txt
Ts0 f187 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
        <nameStyle>3,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f187 736 918 736 972 #arcP
Ts0 f187 0 0.6188687067095846 0 0 #arcLabel
Ts0 f216 expr in #txt
Ts0 f216 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
        <nameStyle>2,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f216 750 904 754 1116 #arcP
Ts0 f216 1 896 904 #addKink
Ts0 f216 2 896 1088 #addKink
Ts0 f216 1 0.22822035794617 0 0 #arcLabel
Ts0 f215 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>exception?</name>
        <nameStyle>10,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f215 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f215 2130 1090 28 28 14 0 #rect
Ts0 f215 @|AlternativeIcon #fIcon
Ts0 f217 expr out #txt
Ts0 f217 2144 1044 2144 1090 #arcP
Ts0 f218 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>show
error dialog</name>
        <nameStyle>17,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f218 targetWindow NEW #txt
Ts0 f218 targetDisplay TOP #txt
Ts0 f218 richDialogId ch.ivyteam.ivy.addons.commondialogs.ErrorDialog #txt
Ts0 f218 startMethod showError(java.lang.Throwable,Boolean,Boolean) #txt
Ts0 f218 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f218 requestActionDecl '<java.lang.Throwable error, Boolean showCopyButton, Boolean showDetailButton> param;' #txt
Ts0 f218 requestMappingAction 'param.showCopyButton=true;
param.showDetailButton=true;
' #txt
Ts0 f218 requestActionCode 'param.error = new java.lang.Exception(
	ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/delegateTaskFailed").toString() + in.selectedTask.getIdentifier(),
	in.exception);

ivy.log.error(ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/delegateTaskFailed").toString() + in.selectedTask.getIdentifier(), 
	in.exception);' #txt
Ts0 f218 responseActionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f218 responseMappingAction 'out=in;
' #txt
Ts0 f218 windowConfiguration '#Mon Apr 27 00:03:57 CEST 2009
height=0
maximized=false
centered=true
close_after_last_rd=true
resizable=true
width=0
title=Error
' #txt
Ts0 f218 isAsynch false #txt
Ts0 f218 isInnerRd true #txt
Ts0 f218 isDialog true #txt
Ts0 f218 2230 1132 36 24 20 -2 #rect
Ts0 f218 @|RichDialogIcon #fIcon
Ts0 f26 expr out #txt
Ts0 f26 2248 1156 2157 1200 #arcP
Ts0 f26 1 2248 1200 #addKink
Ts0 f26 1 0.2739507445357235 0 0 #arcLabel
Ts0 f220 expr in #txt
Ts0 f220 outCond 'in.#exception == null' #txt
Ts0 f220 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
        <nameStyle>3,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f220 2144 1118 2144 1187 #arcP
Ts0 f219 expr in #txt
Ts0 f219 2158 1104 2248 1132 #arcP
Ts0 f219 1 2248 1104 #addKink
Ts0 f219 0 0.6761540741249316 0 0 #arcLabel
Ts0 f221 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>initializeTaskHierarchyLayoutPrefferedIndex()</name>
    </language>
</elementInfo>
' #txt
Ts0 f221 guid 120E8753A7E125B8 #txt
Ts0 f221 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f221 method initializeTaskHierarchyLayoutPrefferedIndex() #txt
Ts0 f221 710 62 20 20 13 0 #rect
Ts0 f221 @|RichDialogMethodStartIcon #fIcon
Ts0 f222 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f222 707 235 26 26 14 0 #rect
Ts0 f222 @|RichDialogProcessEndIcon #fIcon
Ts0 f224 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>initialize with preffered 
task hierarchy layout index</name>
        <nameStyle>54,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f224 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f224 actionTable 'out=in;
' #txt
Ts0 f224 actionCode 'import ch.ivyteam.ivy.workflow.ui.utils.UserPropertyKeys;
Boolean hasUserReadPropertyPermission = ivy.session.hasPermission(ivy.request.getApplication().getSecurityDescriptor(), ch.ivyteam.ivy.security.IPermission.USER_READ_PROPERTY);

panel.taskHierarchyLayoutSelectRDC.setSelectedTaskHierarchyLayoutIndex(
	(hasUserReadPropertyPermission && ivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_KEY).length() > 0)?
	ivy.session.getSessionUser().getProperty(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_KEY).toNumber():
	ivy.cms.co(UserPropertyKeys.TASKS_HIERARCHY_LAYOUT_INDEX_PROPERTY_CMS_DEFAULT_VALUE).toNumber());
	
panel.tasksHierarchyLayoutTree.autoSelectFirstEntry  = true;' #txt
Ts0 f224 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f224 702 132 36 24 31 -8 #rect
Ts0 f224 @|RichDialogProcessStepIcon #fIcon
Ts0 f225 expr out #txt
Ts0 f225 720 82 720 132 #arcP
Ts0 f223 expr out #txt
Ts0 f223 720 156 720 235 #arcP
Ts0 f195 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>if Filter defined
filter defined to true
filter enabled to true</name>
        <nameStyle>63,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ts0 f195 actionDecl 'ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData out;
' #txt
Ts0 f195 actionTable 'out=in;
' #txt
Ts0 f195 actionCode '
if(out.taskAvailableFilters.#propertyFilter!=null)
{ 
	out.filterDefined = true;
	out.filterEnabled = true;
}
else
{	
	out.filterDefined = false;
	out.filterEnabled = false;
	
}' #txt
Ts0 f195 type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
Ts0 f195 2214 116 36 24 23 -12 #rect
Ts0 f195 @|RichDialogProcessStepIcon #fIcon
Ts0 f203 expr out #txt
Ts0 f203 2232 50 2232 116 #arcP
Ts0 f203 0 0.49953020284021993 0 0 #arcLabel
Ts0 f133 expr out #txt
Ts0 f133 2232 140 2090 176 #arcP
Ts0 f133 1 2232 176 #addKink
Ts0 f133 1 0.3359627562226201 0 0 #arcLabel
>Proto Ts0 .type ch.ivyteam.ivy.workflow.ui.task.TaskSearch.TaskSearchData #txt
>Proto Ts0 .processKind RICH_DIALOG #txt
>Proto Ts0 .ui2RdDataAction 'out.filterEnabled=panel.applyFilterToggleButton.selected;
out.sortByPriority=panel.tasksSortedByPriorityCheckBox.selected;
' #txt
>Proto Ts0 .rdData2UIAction 'panel.applyFilterToggleButton.enabled=in.filterDefined;
panel.applyFilterToggleButton.selected=in.filterEnabled;
panel.applyFilterToggleButton.text=(in.filterEnabled? ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/filterEnabledShortDesc"): 
					ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/filterDisabledShortDesc"));
panel.applyFilterToggleButton.toolTipText=(in.filterEnabled? ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/filterEnabledLongDesc"):
					ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/filterDisabledLongDesc"));
panel.defineFilterHyperlink.toolTipText=(in.filterDefined? 

ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/youDefinedFollowingFilters") + "<br>" + 

"<table>" + 
	
   "<tr><th align=''left''>" + ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/taskDisplayMode") + "</th><td>" + 
    "= " + ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/task/plainStrings/taskDisplayMode" + in.taskDisplayMode + "ShortDesc") +
   + "</td></tr>"

+


IF((in.taskAvailableFilters.caseProcessCategoriesFilterIsDefined), 
   "<tr><th align=''left''>" + in.taskAvailableFilters.caseProcessCategoriesFilter.category.property + "</th><td>" + 
      + in.taskAvailableFilters.caseProcessCategoriesFilter.relationalOperator + " " + 
      in.taskAvailableFilters.caseProcessCategoriesFilter.category.categoryCode + "</td></tr>",
   "")
+

IF ((in.taskAvailableFilters.caseProcessesFilterIsDefined),
   "<tr><th align=''left''>" + in.taskAvailableFilters.caseProcessesFilter.category.property + "</th><td>" + 
      + in.taskAvailableFilters.caseProcessesFilter.relationalOperator + " " + 
      in.taskAvailableFilters.caseProcessesFilter.category.categoryCode + "</td></tr>", 
   "")
+

IF ((in.taskAvailableFilters.caseTypesFilterIsDefined),
   "<tr><th align=''left''>" + in.taskAvailableFilters.caseTypesFilter.category.property + "</th><td>" + 
      + in.taskAvailableFilters.caseTypesFilter.relationalOperator + " " + 
      in.taskAvailableFilters.caseTypesFilter.category.categoryCode + "</td></tr>",
   "")
+

IF ((in.taskAvailableFilters.caseSubTypesFilterIsDefined),
   "<tr><th align=''left''>" + in.taskAvailableFilters.caseSubTypesFilter.category.property + "</th><td>" + 
      + in.taskAvailableFilters.caseSubTypesFilter.relationalOperator + " " + 
      in.taskAvailableFilters.caseSubTypesFilter.category.categoryCode + "</td></tr>", 
   "")
+

IF((in.taskAvailableFilters.businessMainContactIdFilterIsDefined), 
   "<tr><th align=''left''>" + in.taskAvailableFilters.businessMainContactIdFilter.property + "</th><td>" + 
      + in.taskAvailableFilters.businessMainContactIdFilter.relationalOperator + " " + 
      in.taskAvailableFilters.businessMainContactIdFilter.value + "</td></tr>",
   "")
+   

IF((in.taskAvailableFilters.businessMainContactNameFilterIsDefined), 
   "<tr><th align=''left''>" + in.taskAvailableFilters.businessMainContactNameFilter.property + "</th><td>" + 
      + in.taskAvailableFilters.businessMainContactNameFilter.relationalOperator + " " + 
      in.taskAvailableFilters.businessMainContactNameFilter.value + "</td></tr>",
   "")
+   

IF((in.taskAvailableFilters.businessCreatorUserFilterIsDefined), 
   "<tr><th align=''left''>" + in.taskAvailableFilters.businessCreatorUserFilter.property + "</th><td>" + 
      + in.taskAvailableFilters.businessCreatorUserFilter.relationalOperator + " " + 
      in.taskAvailableFilters.businessCreatorUserFilter.value + "</td></tr>",
   "")  

+  

IF((in.taskAvailableFilters.businessStartTimestampFromFilterIsDefined), 
   "<tr><th align=''left''>" + in.taskAvailableFilters.businessStartTimestampFromFilter.property + "</th><td>" + 
      + in.taskAvailableFilters.businessStartTimestampFromFilter.relationalOperator + " " + 
      in.taskAvailableFilters.businessStartTimestampFromFilter.value + "</td></tr>",
   "")
+

IF((in.taskAvailableFilters.businessStartTimestampToFilterIsDefined), 
   "<tr><th align=''left''>" + in.taskAvailableFilters.businessStartTimestampToFilter.property + "</th><td>" + 
      + in.taskAvailableFilters.businessStartTimestampToFilter.relationalOperator + " " + 
      in.taskAvailableFilters.businessStartTimestampToFilter.value + "</td></tr>",
   "") 
+

IF((in.taskAvailableFilters.taskStageFilterIsDefined), 
   "<tr><th align=''left''>" + in.taskAvailableFilters.taskStageFilter.property + "</th><td>" + 
      + in.taskAvailableFilters.taskStageFilter.relationalOperator + " " + 
      in.taskAvailableFilters.taskStageFilter.value + "</td></tr>",
   "")  

+ "</table>"
   :
   
   ivy.cms.co("/ch/ivyteam/ivy/workflow/ui/common/plainStrings/noFilterDefined").toString());
panel.delegateTaskButton.visible=in.runningTaskMode;
panel.delegateTaskMenuItem.visible=in.runningTaskMode;
panel.footerLabel.text=in.footerMessage;
panel.startTaskButton.visible=in.runningTaskMode;
panel.startTaskMenuItem.visible=in.runningTaskMode;
panel.tasksHierarchyLayoutTree.treeData=in.tasksHierarchyLayoutTree;
panel.tasksSortedByPriorityCheckBox.selected=in.sortByPriority;
' #txt
>Proto Ts0 -8 -8 16 16 16 26 #rect
>Proto Ts0 '' #fIcon
Ts0 f38 head f33 mainIn #connect
Ts0 f14 mainOut f69 tail #connect
Ts0 f69 head f68 mainIn #connect
Ts0 f30 out f38 tail #connect
Ts0 f33 mainOut f17 tail #connect
Ts0 f17 head f16 in #connect
Ts0 f30 out f27 tail #connect
Ts0 f27 head f16 in #connect
Ts0 f68 mainOut f43 tail #connect
Ts0 f43 head f42 in #connect
Ts0 f19 head f30 in #connect
Ts0 f42 out f154 tail #connect
Ts0 f154 head f153 mainIn #connect
Ts0 f42 out f19 tail #connect
Ts0 f190 head f18 mainIn #connect
Ts0 f11 mainOut f162 tail #connect
Ts0 f162 head f188 in #connect
Ts0 f186 mainOut f20 tail #connect
Ts0 f20 head f18 mainIn #connect
Ts0 f36 mainOut f57 tail #connect
Ts0 f57 head f55 in #connect
Ts0 f58 head f47 mainIn #connect
Ts0 f157 head f156 mainIn #connect
Ts0 f158 head f62 mainIn #connect
Ts0 f159 head f63 mainIn #connect
Ts0 f160 head f70 mainIn #connect
Ts0 f161 head f82 mainIn #connect
Ts0 f178 head f177 mainIn #connect
Ts0 f16 out f179 tail #connect
Ts0 f179 head f23 mainIn #connect
Ts0 f16 out f157 tail #connect
Ts0 f16 out f158 tail #connect
Ts0 f16 out f159 tail #connect
Ts0 f16 out f160 tail #connect
Ts0 f16 out f161 tail #connect
Ts0 f16 out f178 tail #connect
Ts0 f1 mainOut f2 tail #connect
Ts0 f2 head f68 mainIn #connect
Ts0 f22 mainOut f32 tail #connect
Ts0 f32 head f31 in #connect
Ts0 f35 mainOut f40 tail #connect
Ts0 f40 head f25 mainIn #connect
Ts0 f39 head f35 mainIn #connect
Ts0 f45 mainOut f64 tail #connect
Ts0 f64 head f59 in #connect
Ts0 f59 out f73 tail #connect
Ts0 f73 head f72 mainIn #connect
Ts0 f49 mainOut f84 tail #connect
Ts0 f84 head f75 in #connect
Ts0 f77 mainOut f80 tail #connect
Ts0 f80 head f47 mainIn #connect
Ts0 f95 head f94 mainIn #connect
Ts0 f21 mainOut f53 tail #connect
Ts0 f53 head f52 in #connect
Ts0 f60 mainOut f92 tail #connect
Ts0 f92 head f44 mainIn #connect
Ts0 f48 mainOut f103 tail #connect
Ts0 f103 head f102 in #connect
Ts0 f102 out f105 tail #connect
Ts0 f105 head f104 mainIn #connect
Ts0 f104 mainOut f101 tail #connect
Ts0 f101 head f44 mainIn #connect
Ts0 f102 out f106 tail #connect
Ts0 f106 head f44 mainIn #connect
Ts0 f52 out f108 tail #connect
Ts0 f108 head f107 mainIn #connect
Ts0 f107 mainOut f111 tail #connect
Ts0 f111 head f109 in #connect
Ts0 f109 out f99 tail #connect
Ts0 f99 head f48 mainIn #connect
Ts0 f109 out f115 tail #connect
Ts0 f115 head f60 mainIn #connect
Ts0 f112 mainOut f117 tail #connect
Ts0 f117 head f116 in #connect
Ts0 f116 out f119 tail #connect
Ts0 f119 head f118 mainIn #connect
Ts0 f116 out f124 tail #connect
Ts0 f124 head f123 mainIn #connect
Ts0 f123 mainOut f125 tail #connect
Ts0 f125 head f113 mainIn #connect
Ts0 f118 mainOut f120 tail #connect
Ts0 f120 head f114 mainIn #connect
Ts0 f114 mainOut f127 tail #connect
Ts0 f127 head f126 in #connect
Ts0 f126 out f129 tail #connect
Ts0 f129 head f128 mainIn #connect
Ts0 f128 mainOut f122 tail #connect
Ts0 f122 head f113 mainIn #connect
Ts0 f126 out f130 tail #connect
Ts0 f130 head f113 mainIn #connect
Ts0 f62 mainOut f79 tail #connect
Ts0 f79 head f24 mainIn #connect
Ts0 f24 mainOut f98 tail #connect
Ts0 f98 head f15 mainIn #connect
Ts0 f156 mainOut f131 tail #connect
Ts0 f131 head f24 mainIn #connect
Ts0 f23 mainOut f61 tail #connect
Ts0 f61 head f24 mainIn #connect
Ts0 f63 mainOut f89 tail #connect
Ts0 f89 head f24 mainIn #connect
Ts0 f70 mainOut f110 tail #connect
Ts0 f110 head f24 mainIn #connect
Ts0 f82 mainOut f121 tail #connect
Ts0 f121 head f24 mainIn #connect
Ts0 f177 mainOut f132 tail #connect
Ts0 f132 head f24 mainIn #connect
Ts0 f5 out f146 tail #connect
Ts0 f146 head f145 mainIn #connect
Ts0 f145 mainOut f147 tail #connect
Ts0 f147 head f18 mainIn #connect
Ts0 f148 out f152 tail #connect
Ts0 f152 head f151 mainIn #connect
Ts0 f151 mainOut f150 tail #connect
Ts0 f150 head f75 in #connect
Ts0 f148 out f34 tail #connect
Ts0 f34 head f49 mainIn #connect
Ts0 f141 out f163 tail #connect
Ts0 f163 head f155 mainIn #connect
Ts0 f155 mainOut f140 tail #connect
Ts0 f140 head f139 mainIn #connect
Ts0 f141 out f167 tail #connect
Ts0 f167 head f166 mainIn #connect
Ts0 f166 mainOut f168 tail #connect
Ts0 f168 head f139 mainIn #connect
Ts0 f136 mainOut f170 tail #connect
Ts0 f170 head f169 in #connect
Ts0 f169 out f142 tail #connect
Ts0 f142 head f141 in #connect
Ts0 f52 out f87 tail #connect
Ts0 f87 head f60 mainIn #connect
Ts0 f172 out f56 tail #connect
Ts0 f56 head f45 mainIn #connect
Ts0 f31 out f173 tail #connect
Ts0 f173 head f172 in #connect
Ts0 f31 out f39 tail #connect
Ts0 f100 mainOut f12 tail #connect
Ts0 f12 head f10 mainIn #connect
Ts0 f37 mainOut f137 tail #connect
Ts0 f137 head f68 mainIn #connect
Ts0 f0 mainOut f180 tail #connect
Ts0 f180 head f138 mainIn #connect
Ts0 f81 mainOut f9 tail #connect
Ts0 f9 head f138 mainIn #connect
Ts0 f138 mainOut f8 tail #connect
Ts0 f8 head f71 mainIn #connect
Ts0 f13 mainOut f83 tail #connect
Ts0 f83 head f74 mainIn #connect
Ts0 f74 mainOut f134 tail #connect
Ts0 f134 head f100 mainIn #connect
Ts0 f184 mainOut f6 tail #connect
Ts0 f6 head f4 mainIn #connect
Ts0 f41 mainOut f135 tail #connect
Ts0 f135 head f54 mainIn #connect
Ts0 f54 mainOut f50 tail #connect
Ts0 f50 head f71 mainIn #connect
Ts0 f196 out f78 tail #connect
Ts0 f78 head f77 mainIn #connect
Ts0 f196 out f199 tail #connect
Ts0 f199 head f76 mainIn #connect
Ts0 f76 mainOut f200 tail #connect
Ts0 f200 head f47 mainIn #connect
Ts0 f55 out f85 tail #connect
Ts0 f85 head f51 mainIn #connect
Ts0 f55 out f58 tail #connect
Ts0 f46 mainOut f90 tail #connect
Ts0 f90 head f88 in #connect
Ts0 f96 head f47 mainIn #connect
Ts0 f28 out f97 tail #connect
Ts0 f97 head f148 in #connect
Ts0 f29 out f193 tail #connect
Ts0 f193 head f149 in #connect
Ts0 f5 out f204 tail #connect
Ts0 f204 head f186 mainIn #connect
Ts0 f188 out f91 tail #connect
Ts0 f91 head f29 in #connect
Ts0 f188 out f190 tail #connect
Ts0 f29 out f143 tail #connect
Ts0 f143 head f5 in #connect
Ts0 f149 out f144 tail #connect
Ts0 f144 head f5 in #connect
Ts0 f189 mainOut f205 tail #connect
Ts0 f205 head f201 mainIn #connect
Ts0 f191 mainOut f194 tail #connect
Ts0 f194 head f201 mainIn #connect
Ts0 f192 mainOut f165 tail #connect
Ts0 f165 head f201 mainIn #connect
Ts0 f201 mainOut f164 tail #connect
Ts0 f164 head f68 mainIn #connect
Ts0 f149 out f207 tail #connect
Ts0 f207 head f206 mainIn #connect
Ts0 f206 mainOut f208 tail #connect
Ts0 f208 head f18 mainIn #connect
Ts0 f169 out f211 tail #connect
Ts0 f211 head f175 mainIn #connect
Ts0 f175 mainOut f171 tail #connect
Ts0 f171 head f139 mainIn #connect
Ts0 f3 mainOut f214 tail #connect
Ts0 f214 head f184 mainIn #connect
Ts0 f88 out f182 tail #connect
Ts0 f182 head f181 mainIn #connect
Ts0 f88 out f96 tail #connect
Ts0 f181 mainOut f93 tail #connect
Ts0 f93 head f28 in #connect
Ts0 f51 mainOut f183 tail #connect
Ts0 f183 head f75 in #connect
Ts0 f94 mainOut f185 tail #connect
Ts0 f185 head f196 in #connect
Ts0 f75 out f197 tail #connect
Ts0 f197 head f196 in #connect
Ts0 f75 out f95 tail #connect
Ts0 f59 out f86 tail #connect
Ts0 f86 head f25 mainIn #connect
Ts0 f172 out f198 tail #connect
Ts0 f198 head f25 mainIn #connect
Ts0 f65 mainOut f202 tail #connect
Ts0 f202 head f66 mainIn #connect
Ts0 f67 mainOut f176 tail #connect
Ts0 f176 head f174 mainIn #connect
Ts0 f209 ao f210 tail #connect
Ts0 f210 head f67 @CG|ai #connect
Ts0 f28 out f213 tail #connect
Ts0 f213 head f212 in #connect
Ts0 f212 out f187 tail #connect
Ts0 f187 head f36 mainIn #connect
Ts0 f212 out f216 tail #connect
Ts0 f216 head f51 mainIn #connect
Ts0 f72 mainOut f217 tail #connect
Ts0 f217 head f215 in #connect
Ts0 f218 mainOut f26 tail #connect
Ts0 f26 head f25 mainIn #connect
Ts0 f215 out f220 tail #connect
Ts0 f220 head f25 mainIn #connect
Ts0 f215 out f219 tail #connect
Ts0 f219 head f218 mainIn #connect
Ts0 f221 mainOut f225 tail #connect
Ts0 f225 head f224 mainIn #connect
Ts0 f224 mainOut f223 tail #connect
Ts0 f223 head f222 mainIn #connect
Ts0 f7 mainOut f203 tail #connect
Ts0 f203 head f195 mainIn #connect
Ts0 f195 mainOut f133 tail #connect
Ts0 f133 head f100 mainIn #connect
