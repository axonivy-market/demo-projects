<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:cc="http://xmlns.jcp.org/jsf/composite"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:pe="http://primefaces.org/ui/extensions">

<cc:interface componentType="IvyComponent">
</cc:interface>

<cc:implementation>
	<div class="container-fluid">
		<ic:com.axonivy.engine.config.ui.settings.component.LicenceInfoComponent
			id="licenceInfosComponent" />
		<br />
		<p>
			<p:commandLink id="details" value="Show Licence Details"
				onclick="PF('licenceDetails').show()"
				rendered="#{!licenceBean.demo}" />
		</p>
		<div class="row">
			<div class="col-xs-3">
				<ic:com.axonivy.engine.config.ui.settings.component.LicenceUploadComponent
					id="licenceUploadComponent" />
			</div>
			<div class="col-xs-3" style="float: right">
				<p:commandButton id="systemDatabaseTabNextButton" value="Next"
					icon="fa fa-arrow-circle-right" styleClass="next-button"
					onclick="if(#{licenceBean.demo}) PF('nextStepLicenceDialog').show(); else PF('accordionPanel').select(1);" />
			</div>

			<c:if
				test="#{!licenceBean.demo and data.renewLicenceData.showRenewLicence}">
				<div>
					<p:commandButton id="renew" value="Renew Licence"
						oncomplete="PF('renewLicence').show()"
						actionListener="#{logic.setAdmin}" update="renewLicenceWindow"
						style="background-color: #{data.renewLicenceData.licenceWarning}" />
					<p:spacer width="10px" />
					<h:outputLabel rendered="#{data.renewLicenceData.daysLeft lt 30}"
						style="color: #{data.renewLicenceData.licenceWarning}"
						value="Your license expires in #{data.renewLicenceData.daysLeft} days" />
				</div>
			</c:if>
		</div>
	</div>
	<p:dialog widgetVar="licenceDetails" modal="true" closeOnEscape="true"
		header="Details">
		<ic:com.axonivy.engine.config.ui.settings.component.LicenceDetailComponent
			id="licenceDetailComponent" />
	</p:dialog>

	<p:dialog id="renewLicenceWindow" widgetVar="renewLicence"
		closeOnEscape="true" header="Renew Licence" modal="true"
		resizable="false">
		<h:form>
			<h:panelGrid>
				<p:outputLabel value="Where do you want to send the Licence to?" />
				<br />
				<p:inputText value="#{data.renewLicenceData.renewEmail}"
					type="email" placeholder="E-Mail" required="true"
					requiredMessage="Put Email" />
				<br />
				<p:commandButton type="submit" value="Send request"
					actionListener="#{logic.renewLicence}"
					onclick="PF('renewLicence').hide();" update=":responseGrowl" />
			</h:panelGrid>
		</h:form>
	</p:dialog>

	<p:dialog widgetVar="nextStepLicenceDialog" id="nextStepLicenceDialog"
		header="Licence required" modal="true" closeOnEscape="true">
		<h:outputText
			value="You can't use this ivy-server in production, if you don't upload a valid licence." />
		<br />
		<br />
		<h:form id="nextStepLicenceDialogForm">
			<h:panelGrid columns="3">
				<ic:com.axonivy.engine.config.ui.settings.component.LicenceUploadComponent
					id="licenceDialogUploadComponent" />
				<p:commandButton value="Cancel" id="cancelLicenceButton"
					icon="fa fa-times" onclick="PF('nextStepLicenceDialog').hide()" />
			</h:panelGrid>
			<p:defaultCommand target="cancelLicenceButton"/>
		</h:form>
	</p:dialog>
</cc:implementation>
</html>