<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:pm="http://primefaces.org/mobile"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:cc="http://xmlns.jcp.org/jsf/composite">
<cc:interface componentType="IvyComponent" />

<cc:implementation>
	<h:form id="webServerForm" styleClass="configChanged">
		<p:focus for="HTTPPortInput" />
		
		<p:outputPanel id="wsIvyYamlHintPanel" styleClass="">
			<p:outputPanel id="wsYamlHint"
				styleClass="alert alert-success connection-state">
				<h4>
					<i class="fa fa-info-circle" />
					<h:outputText value=" Hint: ivy.yaml" styleClass="configChanged" />
				</h4>
				<p>
					<h:outputText
						value="This configruation can also be defined in the ivy.yaml file. 
						Configruation defined here will be written to the system database.
						The definitions in the ivy.yaml file will override the settings in the system database."
						styleClass="configChanged" />
				</p>
			</p:outputPanel>
		</p:outputPanel>
		
		<h:panelGrid columns="3" cellpadding="20" cellspacing="20"
			rendered="#{data.settings.connectionInfo.connectionOK}">
			<p:fieldset id="HTTPFieldSet" legend="HTTP Connector">
				<h:panelGrid columns="2" cellpadding="5" cellspacing="10">
					<p:outputLabel for="HTTPEnabledCheckbox" id="HTTPEnabledLabel"
						value="Enabled: " />
					<p:selectBooleanCheckbox id="HTTPEnabledCheckbox"
						styleClass="webserver-checkbox"
						value="#{data.settings.webServerConfig.httpEnabled}">
						<p:ajax listener="#{logic.saveEasyProps}" update="accordionPanel:webServerComponent:advancedSystemPropertiesForm:propertiesTable"/>
					</p:selectBooleanCheckbox>

					<p:outputLabel for="HTTPPortInput" id="HTTPPortLabel"
						value="Port: " />
					<p:inputText id="HTTPPortInput" styleClass="port-input"
						value="#{data.settings.webServerConfig.httpPort}">
						<p:ajax event="keyup" listener="#{logic.saveEasyProps}"/>
					</p:inputText>
				</h:panelGrid>
			</p:fieldset>

			<p:fieldset id="HTTPSFieldSet" legend="HTTPS Connector">
				<h:panelGrid columns="2" cellpadding="5" cellspacing="10">
					<p:outputLabel for="HTTPSEnabledCheckbox" id="HTTPSEnabledLabel"
						value="Enabled: " />
					<p:selectBooleanCheckbox id="HTTPSEnabledCheckbox"
						styleClass="webserver-checkbox"
						value="#{data.settings.webServerConfig.httpsEnabled}">
						<p:ajax listener="#{logic.saveEasyProps}" update="accordionPanel:webServerComponent:advancedSystemPropertiesForm:propertiesTable"/>
					</p:selectBooleanCheckbox>

					<p:outputLabel for="HTTPSPortInput" id="HTTPSPortLabel"
						value="Port: " />
					<p:inputText id="HTTPSPortInput" styleClass="port-input"
						value="#{data.settings.webServerConfig.httpsPort}">
						<p:ajax event="keyup" listener="#{logic.saveEasyProps}"/>
					</p:inputText>
				</h:panelGrid>
			</p:fieldset>

			<p:fieldset id="AJPFieldSet" legend="AJP Connector">
				<h:panelGrid columns="2" cellpadding="5" cellspacing="10">
					<p:outputLabel for="AJPEnabledCheckbox" id="AJPEnabledLabel"
						value="Enabled: " />
					<p:selectBooleanCheckbox id="AJPEnabledCheckbox"
						styleClass="webserver-checkbox"
						value="#{data.settings.webServerConfig.ajpEnabled}">
						<p:ajax listener="#{logic.saveEasyProps}" update="accordionPanel:webServerComponent:advancedSystemPropertiesForm:propertiesTable"/>
					</p:selectBooleanCheckbox>

					<p:outputLabel for="AJPPortInput" id="AJPPortLabel" value="Port: " />
					<p:inputText id="AJPPortInput" styleClass="port-input"
						value="#{data.settings.webServerConfig.ajpPort}">
						<p:ajax event="keyup" listener="#{logic.saveEasyProps}"/>
					</p:inputText>
				</h:panelGrid>
			</p:fieldset>
		</h:panelGrid>
		<p:commandButton id="advancedSystemPropertiesButton" value="Advanced"
			icon="fa fa-cogs"
			rendered="#{data.settings.connectionInfo.connectionOK}"
			onclick="PF('advancedSystemPropertiesDialog').show();" />
		<p:commandButton id="webServerTabNextButton" value="Next"
			rendered="#{data.settings.connectionInfo.connectionOK}"
			icon="fa fa-arrow-circle-right" styleClass="next-button"
			onclick="PF('accordionPanel').select(4);" />

		<ic:com.axonivy.engine.config.ui.settings.component.ConnectionStateComponent
			id="connectionStateComponent" settings="#{data.settings}"
			rendered="#{!data.settings.connectionInfo.connectionOK}" />

		<p:defaultCommand target="webServerTabNextButton" />
	</h:form>

	<p:dialog widgetVar="advancedSystemPropertiesDialog"
		id="advancedSystemPropertiesDialog" header="Web Server System Properties"
		closeOnEscape="true" modal="true" width="1000px"
		styleClass="configChanged">
		<h:form id="advancedSystemPropertiesForm">
			<p:outputLabel
				value="These are all the system properties of the Web Server." />
			<br />
			<br />
			<p:dataTable id="propertiesTable" editable="true" editMode="row"
				value="#{data.properties}" var="property" scrollable="true"
				scrollHeight="500">
				<p:ajax event="rowEdit" listener="#{logic.saveSystemProps}"
					update="accordionPanel:webServerComponent:webServerForm" />
				<p:column headerText="Key" width="30%">
					<strong> 
						<h:outputText value="#{property.name}" />
					</strong>
					<br />
					<h:outputText value="#{property.description}" />
				</p:column>
				<p:column headerText="Default" width="20%">
					<h:outputText value="#{property.defaultValue}" />
				</p:column>
				<p:column headerText="Value" width="20%">
					<p:cellEditor id="cellEditor">
						<f:facet name="output">
							<h:outputText
								value="#{property.value eq null ? property.defaultValue : property.value}"
								rendered="#{property.userInterfaceFormat ne 'PASSWORD'}" />
							<h:outputText value="********"
								rendered="#{property.userInterfaceFormat eq 'PASSWORD'}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText id="string" value="#{property.value}"
								rendered="#{property.userInterfaceFormat eq 'STRING'}" />
							<p:inputNumber id="number" value="#{property.value}"
								rendered="#{property.userInterfaceFormat eq 'NUMBER'}"
								decimalPlaces="0" thousandSeparator="" />
							<p:selectBooleanCheckbox id="boolCheckBox" value="#{property.value}"
								rendered="#{property.userInterfaceFormat eq 'TRUE_FALSE'
								or property.userInterfaceFormat eq 'YES_NO'}"
								converter="booleanToStringConverter" />
							<p:password id="password" value="#{property.value}"
								rendered="#{property.userInterfaceFormat eq 'PASSWORD'}" />
							<p:selectOneMenu id="enumMenu" value="#{property.value}"
								rendered="#{property.userInterfaceFormat eq 'ENUMERATION'}">
								<f:selectItems value="#{property.enumerationValues}" />
							</p:selectOneMenu>
						</f:facet>
					</p:cellEditor>
				</p:column>
				<p:column style="width:15px">
					<p:rowEditor id="rowEditor" saveTitle="Save" cancelTitle="Cancel" editTitle="Edit" />
				</p:column>
			</p:dataTable>
		</h:form>
	</p:dialog>
</cc:implementation>
</html>