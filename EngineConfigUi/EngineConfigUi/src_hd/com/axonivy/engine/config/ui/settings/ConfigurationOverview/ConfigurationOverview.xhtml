<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:ic="http://ivyteam.ch/jsf/component"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<h:body>
	<ui:composition template="/layouts/basic.xhtml">
		<ui:define name="title">Engine Configuration</ui:define>
		<ui:define name="content">
			<script type="text/javascript">
				function submitConfigForm() {
					PrimeFaces.ajax.Request.handle({
						formId : "systemDatabaseForm",
						source : "systemDatabaseForm",
						process : "systemDatabaseForm"
					});
				}
			</script>
			<p:growl id="responseGrowl" showDetail="true" sticky="true"/>
			<p:growl id="growl" showDetail="true" showSummary="false" />
			<p:accordionPanel id="accordionPanel" styleClass="full-width"
				widgetVar="accordionPanel" activeIndex="#{data.activeTabIndex}">
				<p:ajax event="tabChange" listener="#{logic.tabChange}"
					update="@(.configChanged)" onstart="submitConfigForm();" />

				<p:tab id="licenceInfoTab">
					<f:facet name="title">
						<i class="fa fa-info-circle" />
						<h:outputText value=" Licence" />
					</f:facet>
					<ic:com.axonivy.engine.config.ui.settings.component.LicenceComponent
						id="licenceComponent" styleClass="updateSaveAll" />
				</p:tab>

				<p:tab id="systemDatabaseTab">
					<f:facet name="title">
						<i class="fa fa-database" />
						<h:outputText value=" System Database" />
					</f:facet>
					<ic:com.axonivy.engine.config.ui.settings.component.SystemDatabaseComponent
						settings="#{data.databaseSettings}" id="systemDatabaseComponent"
						styleClass="updateSaveAll" />
				</p:tab>

				<p:tab id="administratorsTab">
					<f:facet name="title">
						<i class="fa fa-user-secret" />
						<h:outputText value=" Administrators" />
					</f:facet>
					<ic:com.axonivy.engine.config.ui.settings.component.AdministratorsComponent
						settings="#{data.databaseSettings}" id="administratorsComponent"
						styleClass="updateSaveAll" />
				</p:tab>

				<p:tab id="webServerTab">
					<f:facet name="title">
						<i class="fa fa-server" />
						<h:outputText value=" Web Server" />
					</f:facet>
					<ic:com.axonivy.engine.config.ui.settings.component.WebServerComponent
						settings="#{data.databaseSettings}" id="webServerComponent"
						styleClass="updateSaveAll" />
				</p:tab>

				<p:tab id="clusterTab"
					rendered="#{data.databaseSettings.connectionInfo.isCluster}">
					<f:facet name="title">
						<i class="fa fa-cubes" />
						<h:outputText value=" Cluster Nodes" />
					</f:facet>
					<ic:com.axonivy.engine.config.ui.settings.component.ClusterComponent
						settings="#{data.databaseSettings}" id="clusterComponent"
						styleClass="updateSaveAll" />
				</p:tab>

				<p:tab id="summaryTab">
					<f:facet name="title">
						<i class="fa fa-list-alt" />
						<h:outputText value=" Summary" />
					</f:facet>
					<ic:com.axonivy.engine.config.ui.settings.component.SummaryComponent
						settings="#{data.databaseSettings}" id="summaryComponent"
						styleClass="updateSaveAll" />
				</p:tab>
			</p:accordionPanel>
			<br />
			<p:commandButton id="saveAll" value="Save" icon="fa fa-save"
				actionListener="#{logic.saveAll}" update="growl, @(.updateSaveAll)"
				onclick="submitConfigForm();" />
			<p:button id="discardChanges" value="Discard Changes"
				icon="fa fa-undo"
				href="#{ivy.html.startref('157E64657EEBDD9C/start.ivp')}" />
			<p:commandButton id="exit" value="Save and Exit"
				rendered="#{helperBean.serverConfigurationApplicaton}"
				icon="fa fa-sign-out" actionListener="#{logic.close}"
				styleClass="save-and-exit-button" onclick="submitConfigForm();" />
			<p:dialog widgetVar="loadingDialog" id="loadingDialog"
				closeOnEscape="false" closable="false" modal="true"
				draggable="false" resizable="false" styleClass="loaderDialog">
				<h:graphicImage name="layouts/images/ajax-loader.gif" alt="Loading"
					styleClass="loadingSpinner" />
				<h:outputText value="Testing connection..." />
			</p:dialog>
		</ui:define>
	</ui:composition>
</h:body>
</html>