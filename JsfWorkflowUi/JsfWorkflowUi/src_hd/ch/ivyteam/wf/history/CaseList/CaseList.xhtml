<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"      
      xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:ic="http://ivyteam.ch/jsf/component"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:pm="http://primefaces.org/mobile">

<ui:composition template="/layouts/Workflow.xhtml">
	<ui:param name="centerHeader" value="#{data.header}" />
	<ui:define name="center">
		<f:event type="preRenderView" listener="#{logic.update()}" />
		<br />
		#{data.caseListMode == 'my_cases' ? ivy.cms.co('/labels/history/workflowHistory/description') : ivy.cms.co('/labels/admin/caseAdmin/description')}
		<br /><br />
		<h:form id="caseListForm">
			<p:toolbar>
		    	<c:if test="#{data.caseListMode == 'my_cases'}">
					<p:toolbarGroup align="left">
			    		<h:panelGrid columns="1">
					        <p:selectOneButton id="caseOption" value="#{data.caseUserMode}">
					            <f:selectItem itemLabel="#{ivy.cms.co('/labels/history/workflowHistory/startedCase')}" itemValue="startedCases" />
					            <f:selectItem itemLabel="#{ivy.cms.co('/labels/history/workflowHistory/involvedCase')}" itemValue="involvedCases" />
					            <p:ajax update=":caseListForm" listener="#{logic.setFilter}" />
					        </p:selectOneButton>
	        			</h:panelGrid>
	       			</p:toolbarGroup>
				</c:if>
	    		<p:toolbarGroup align="right">
		    		<h:panelGrid columns="8">
	 					#{ivy.cms.co('/labels/common/category')}:
	 					<p:selectOneMenu id="categoryFilter" value="#{data.catFilter}">
	 						<f:selectItem itemLabel="#{ivy.cms.co('/labels/common/filterAll')}" itemValue="" />
	           				<f:selectItems value="#{data.categories}" var="categorie" itemLabel="#{categorie}" itemValue="#{categorie}" />
	           				<p:ajax update=":caseListForm" listener="#{logic.setFilter}" />
	        			</p:selectOneMenu>
	        			<p:spacer width="10" />
	        			#{ivy.cms.co('/labels/common/process')}:
	 					<p:selectOneMenu id="processFilter" value="#{data.procFilter}">
	 						<f:selectItem itemLabel="#{ivy.cms.co('/labels/common/filterAll')}" itemValue="" />
	           				<f:selectItems value="#{data.processesList}" var="processe" itemLabel="#{processe}" itemValue="#{processe}" />
	           				<p:ajax update=":caseListForm" listener="#{logic.setFilter}" />
	        			</p:selectOneMenu>
	        			<p:spacer width="10" />
	        			#{ivy.cms.co('/labels/common/taskState')}:
	 					<p:selectOneMenu id="stateFilter" value="#{data.statFilter}">
	 						<f:selectItem itemLabel="#{ivy.cms.co('/labels/common/filterAll')}" itemValue="" />
	           				<f:selectItems value="#{data.states}" var="state" itemLabel="#{state}" itemValue="#{state}" />
	           				<p:ajax update=":caseListForm" listener="#{logic.setFilter}" />
	        			</p:selectOneMenu>
        			</h:panelGrid>
       			</p:toolbarGroup>
			</p:toolbar>
			<p:growl id="growl" showDetail="true" />
   			<p:dataTable id="caseTable" widgetVar="caseTable" var="case" value="#{data.cases}" emptyMessage="#{ivy.cms.co('/labels/common/noCases')}" rowIndexVar="row" paginator="#{data.cases.rowCount >= 50}" paginatorPosition="bottom" rows="50" lazy="true" sortOrder="DESCENDING">
   				<p:column style="width:5%" sortBy="#{ID}">
           			<f:facet name="header">
               			#
           			</f:facet>
           			<a href="#{ivy.html.startref('13FE81B1A4AD784C/CaseDetails.ivp')}?detailCaseId=#{case.id}" id="buttonCaseDetail" title="Details Case [#{case.id}]"><h:graphicImage name="images/actions/case#{case.hasNotes() ? 'WithNote' : ''}.png" alt="" /></a>
        		</p:column>
       			<p:column style="width:65px; text-align: center;" sortBy="#{STATE}">
           			<f:facet name="header">
               			#{ivy.cms.co('/labels/common/state')}
           			</f:facet>
           			<h:graphicImage name="images/details/caseState/#{case.state.intValue()}.png" alt="" title="#{ivy.cms.co('/labels/common/state')} #{case.state}" />
       			</p:column>
       			<p:column sortBy="#{NAME}">
           			<f:facet name="header">
               			#{ivy.cms.co('/labels/common/name')}
           			</f:facet>
           			<a href="#{ivy.html.startref('13FE81B1A4AD784C/CaseDetails.ivp')}?detailCaseId=#{case.id}" id="caseLinkRow" title="Details Case [#{case.id}]">#{case.name}</a>
       			</p:column>
       			<p:column sortBy="#{PROCESS_CATEGORY_CODE}">
           			<f:facet name="header">
               			#{ivy.cms.co('/labels/common/category')}
           			</f:facet>
           			#{case.processCategoryCode}
       			</p:column>
       			<p:column sortBy="#{PROCESS_CODE}">
           			<f:facet name="header">
               			#{ivy.cms.co('/labels/common/process')}
           			</f:facet>
           			#{case.processCode}
       			</p:column>
       			<p:column sortBy="#{START_TIMESTAMP}">
           			<f:facet name="header">
               			#{ivy.cms.co('/labels/common/start')}
           			</f:facet>
           			<h:outputText value="#{case.startTimestamp}">
						<f:convertDateTime type="both" dateStyle="short" timeStyle="short" />
					</h:outputText>
       			</p:column>
   			</p:dataTable>
		</h:form>
	</ui:define>
</ui:composition>
</html>